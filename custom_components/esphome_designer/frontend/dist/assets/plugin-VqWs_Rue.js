const m=()=>window.location.protocol==="file:"||!window.location.hostname,u=(e,s,o)=>{const{getColorStyle:h,selected:f,profile:g}=o||{},i=s.props||{},p=(i.url||"").trim(),r=(i.path||"").replace(/^"|"$/g,"").trim(),l=!!i.invert,y=g?.displayType||"binary";let d="";if(l&&(d+="invert(1) "),y==="binary"?d+="grayscale(100%) contrast(1.5) ":y==="grayscale"&&(d+="grayscale(100%) "),e.style.boxSizing="border-box",e.style.backgroundColor="#f5f5f5",e.style.display="flex",e.style.alignItems="center",e.style.justifyContent="center",e.style.overflow="hidden",e.style.color="#666",e.innerText="",e.style.backgroundImage="",r){const t=r.split(/[/\\]/).pop()||r;e.innerHTML="";const c=document.createElement("img");c.style.maxWidth="100%",c.style.maxHeight="100%",c.style.objectFit="contain",c.draggable=!1,d&&(c.style.filter=d.trim()),c.onerror=()=>{const a=m()?"<br/><span style='color:#e67e22;font-size:8px;'>‚ö†Ô∏è Offline mode - preview in HA</span>":"";e.innerHTML="<div style='text-align:center;color:#666;font-size:11px;padding:8px;line-height:1.4;'>üñºÔ∏è<br/><strong>"+t+"</strong><br/><span style='color:#999;font-size:9px;'>"+(l?"(inverted) ":"")+s.width+"√ó"+s.height+"px</span>"+a+"</div>"},c.onload=()=>{if(f){const a=document.createElement("div");a.style.position="absolute",a.style.bottom="2px",a.style.right="2px",a.style.background="rgba(0,0,0,0.6)",a.style.color="white",a.style.padding="2px 4px",a.style.fontSize="8px",a.style.borderRadius="2px",a.textContent=t+" ‚Ä¢ "+s.width+"√ó"+s.height+"px",e.appendChild(a)}};let n;m()?r.match(/^[A-Za-z]:\\/)?n="file:///"+r.replace(/\\/g,"/"):r.startsWith("/config/")?n=null:n=r:n="/api/esphome_designer/image_proxy?path="+encodeURIComponent(r),n?(c.src=n,e.appendChild(c)):e.innerHTML="<div style='text-align:center;color:#666;font-size:11px;padding:8px;line-height:1.4;'>üñºÔ∏è<br/><strong>"+t+"</strong><br/><span style='color:#999;font-size:9px;'>"+(l?"(inverted) ":"")+s.width+"√ó"+s.height+"px</span><br/><span style='color:#e67e22;font-size:8px;'>‚ö†Ô∏è Preview available in Home Assistant</span></div>";return}if(p){const t=document.createElement("img");t.style.maxWidth="100%",t.style.maxHeight="100%",t.style.objectFit="contain",t.draggable=!1,d&&(t.style.filter=d.trim()),t.onerror=()=>{e.innerHTML="<div style='text-align:center;color:#666;font-size:11px;padding:8px;line-height:1.4;'>üñºÔ∏è<br/><strong>Image</strong><br/><span style='color:#999;font-size:9px;'>"+(l?"(inverted) ":"")+"Load Failed</span></div>"},t.onload=()=>{if(f){const c=p.split("/").pop(),n=document.createElement("div");n.style.position="absolute",n.style.bottom="2px",n.style.right="2px",n.style.background="rgba(0,0,0,0.6)",n.style.color="white",n.style.padding="2px 4px",n.style.fontSize="8px",n.style.borderRadius="2px",n.textContent=c,e.appendChild(n)}},t.src=p,e.appendChild(t)}else{const t=document.createElement("div");t.style.textAlign="center",t.style.color="#aaa",t.style.fontSize="11px",t.innerHTML="üñºÔ∏è<br/>Image Widget<br/><span style='font-size:9px;color:#ccc;'>Enter path in properties ‚Üí</span>",e.appendChild(t)}},x=e=>{const o=((e.props||{}).path||"").replace(/^"|"$/g,"").trim();return o?`img_${o.replace(/[^a-zA-Z0-9]/g,"_").replace(/^_+|_+$/g,"").replace(/_+/g,"_")}_${e.width}x${e.height}`:`img_${e.id.replace(/-/g,"_")}`},b=(e,s)=>{const{lines:o,getCondProps:h,getConditionCheck:f}=s,g=e.props||{},i=(g.path||"").replace(/^"|"$/g,"").trim(),p=!!g.invert;if(!i)return;const r=x(e);o.push(`        // widget:image id:${e.id} type:image x:${e.x} y:${e.y} w:${e.width} h:${e.height} path:"${i}" invert:${p} ${h(e)}`);const l=f(e);l&&o.push(`        ${l}`),p?o.push(`        it.image(${e.x}, ${e.y}, id(${r}), color_off, color_on);`):o.push(`        it.image(${e.x}, ${e.y}, id(${r}));`),l&&o.push("        }")},$=e=>{const{lines:s,widgets:o,profile:h}=e,f=o.filter(g=>g.type==="image");if(f.length>0){const g=new Set,i=[];f.forEach(p=>{const l=((p.props||{}).path||"").replace(/^"|"$/g,"").trim();if(!l)return;const y=x(p);if(g.has(y))return;g.add(y);const d=h.features?.lcd||h.name&&(h.name.includes("6-Color")||h.name.includes("Color")),t=d?"RGB565":"BINARY";i.push(`  - file: "${l}"`),i.push(`    id: ${y}`),i.push(`    type: ${t}`),i.push(`    resize: ${p.width}x${p.height}`),d||(i.push("    dither: FLOYDSTEINBERG"),i.push("    transparency: chroma_key"))}),i.length>0&&(s.push("image:"),s.push(...i),s.push(""))}},v={id:"image",name:"Image",category:"Graphics",defaults:{path:"",url:"",invert:!1,size:"native"},render:u,export:b,onExportComponents:$};export{v as default};
