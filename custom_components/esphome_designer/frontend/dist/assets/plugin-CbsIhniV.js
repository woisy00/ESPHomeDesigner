const m=(e,o,{getColorStyle:i})=>{const s=o.props||{},l=s.url||s.path||"",n=!!s.invert;if(e.style.boxSizing="border-box",e.style.backgroundColor="#f5f5f5",e.style.display="flex",e.style.alignItems="center",e.style.justifyContent="center",e.style.overflow="hidden",e.style.color="#666",e.innerText="",e.style.backgroundImage="",l){const t=document.createElement("img");t.style.maxWidth="100%",t.style.maxHeight="100%",t.style.objectFit="contain",t.draggable=!1,n&&(t.style.filter="invert(1)"),t.onerror=()=>{e.innerHTML="<div style='text-align:center;color:#666;font-size:11px;padding:8px;line-height:1.4;'>üñºÔ∏è<br/><strong>Online Image</strong><br/><span style='color:#999;font-size:9px;'>"+(n?"(inverted) ":"")+"Load Failed</span></div>"},t.onload=()=>{const u=l.split("/").pop(),r=document.createElement("div");r.style.position="absolute",r.style.bottom="2px",r.style.right="2px",r.style.background="rgba(0,0,0,0.6)",r.style.color="white",r.style.padding="2px 4px",r.style.fontSize="8px",r.style.borderRadius="2px",r.textContent=u,e.appendChild(r)},t.src=l,e.appendChild(t)}else{const t=document.createElement("div");t.style.textAlign="center",t.style.color="#aaa",t.style.fontSize="11px",t.innerHTML="üñºÔ∏è<br/>Online Image<br/><span style='font-size:9px;color:#ccc;'>Enter URL in properties ‚Üí</span>",e.appendChild(t)}},_=(e,{common:o,convertColor:i})=>{const s=e.props||{},l=f(e);return{image:{...o,src:l,angle:s.rotation||0,pivot_x:s.pivot_x||0,pivot_y:s.pivot_y||0,image_recolor:i(s.color),image_recolor_opa:"cover"}}},f=e=>`online_img_${e.id.replace(/-/g,"_")}`,$=(e,o)=>{const{lines:i,getCondProps:s,getConditionCheck:l,profile:n}=o,t=e.props||{},u=(t.url||"").trim(),r=!!t.invert,a=t.render_mode||"Auto",c=f(e);i.push(`        // widget:${e.type} id:${e.id} x:${e.x} y:${e.y} w:${e.width} h:${e.height} url:"${u}" invert:${r} render_mode:"${a}" ${s(e)}`);const p=l(e);p&&i.push(`        ${p}`);let d="GRAYSCALE";a==="Binary"?d="BINARY":a==="Grayscale"?d="GRAYSCALE":a==="Color (RGB565)"?d="RGB565":d=n?.features?.lcd||n?.name&&(n.name.includes("6-Color")||n.name.includes("Color"))?"RGB565":"BINARY",d==="BINARY"?r?i.push(`        it.image(${e.x}, ${e.y}, id(${c}), color_off, color_on);`):i.push(`        it.image(${e.x}, ${e.y}, id(${c}), color_on, color_off);`):i.push(`        it.image(${e.x}, ${e.y}, id(${c}));`),p&&i.push("        }")},x=e=>{const{lines:o,widgets:i,profile:s}=e,l=i.filter(n=>n.type==="online_image"||n.type==="puppet");l.length>0&&(o.push("online_image:"),l.forEach(n=>{const t=n.props||{},u=(t.url||"").trim(),r=f(n);if(!u)return;let a=(t.format||"PNG").toUpperCase();a==="JPG"&&(a="JPEG");const c=t.render_mode||"Auto";let p="GRAYSCALE";c==="Binary"?p="BINARY":c==="Grayscale"?p="GRAYSCALE":c==="Color (RGB565)"?p="RGB565":p=s.features?.lcd||s.name&&(s.name.includes("6-Color")||s.name.includes("Color"))?"RGB565":"BINARY";let d=t.update_interval||"never";if(t.interval_s&&t.interval_s>0&&(d=`${t.interval_s}s`),o.push(`  - id: ${r}`),o.push(`    url: "${u}"`),o.push(`    format: ${a}`),o.push(`    type: ${p}`),p!=="BINARY"){const g=parseInt(n.width,10),y=parseInt(n.height,10);o.push(`    resize: ${g}x${y}`)}o.push(`    update_interval: ${d}`);const h=s.features?.lcd?"my_display":"epaper_display";e.isLvgl?(o.push("    on_download_finished:"),o.push("      then:"),o.push(`        - lvgl.widget.refresh: ${n.id}`),o.push("    on_error:"),o.push("      then:"),o.push(`        - lvgl.widget.refresh: ${n.id}`)):(o.push("    on_download_finished:"),o.push("      then:"),o.push(`        - component.update: ${h}`),o.push("    on_error:"),o.push("      then:"),o.push(`        - component.update: ${h}`))}),o.push(""))},v={id:"online_image",name:"Online Image",category:"Graphics",defaults:{url:"",invert:!1,update_interval:"1h",rotation:0,color:"black"},render:m,exportLVGL:_,export:$,onExportComponents:x};export{v as default};
