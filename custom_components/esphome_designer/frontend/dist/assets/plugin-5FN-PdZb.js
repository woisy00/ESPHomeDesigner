const v=(t,{common:e,convertColor:c})=>{const o=t.props||{};return{qrcode:{...e,text:`"${o.text||o.value||"https://esphome.io"}"`,size:Math.min(t.width,t.height),dark_color:c(o.color),light_color:c(o.bg_color||"white")}}},L=(t,e,c)=>{const o=e.props||{},n=o.value||"https://esphome.io",h=o.color||"black",p=o.ecc||"LOW";t.style.boxSizing="border-box",t.style.display="flex",t.style.alignItems="flex-start",t.style.justifyContent="flex-start",t.style.overflow="hidden",t.style.padding="0",t.innerHTML="";const u={LOW:"L",MEDIUM:"M",QUARTILE:"Q",HIGH:"H"}[p]||"L";if(typeof qrcode>"u"){t.innerHTML='<div style="color:#999;font-size:10px;text-align:center;">QR Library<br>Loading...</div>';return}try{const s=qrcode(0,u);s.addData(n),s.make();const r=s.getModuleCount(),y=Math.min(e.width,e.height),i=Math.max(1,Math.floor(y/r)),f=i*r,l=document.createElement("canvas");l.width=f,l.height=f,l.style.imageRendering="pixelated";const x=l.getContext("2d"),$=h==="white"?"#fff":"#000";x.fillStyle=$;for(let d=0;d<r;d++)for(let a=0;a<r;a++)s.isDark(d,a)&&x.fillRect(a*i,d*i,i,i);t.appendChild(l),e.props._calculatedScale=i}catch(s){t.innerHTML='<div style="color:#c00;font-size:10px;text-align:center;">QR Error:<br>'+s.message+"</div>"}},_=(t,e)=>{const{lines:c,getColorConst:o,addDitherMask:n,sanitize:h,getCondProps:p,getConditionCheck:g,isEpaper:u}=e,s=t.props||{},r=h(s.value||"https://esphome.io"),y=s.ecc||"LOW",i=s.color||"black",f=o(i),l=`qr_${t.id}`.replace(/-/g,"_"),x=Math.min(t.width,t.height),$=r.length,d=Math.min(177,21+Math.ceil($/10)*2),a=Math.max(1,Math.floor(x/d));c.push(`        // widget:qr_code id:${t.id} type:qr_code x:${t.x} y:${t.y} w:${t.width} h:${t.height} value:"${r}" scale:${a} ecc:${y} color:${i} ${p(t)}`);const M=g(t);M&&c.push(`        ${M}`),c.push(`        it.qr_code(${t.x}, ${t.y}, id(${l}), ${f}, ${a});`),n(c,i,u,t.x,t.y,t.width,t.height),M&&c.push("        }")},q=t=>{const{lines:e,widgets:c}=t,o=c.filter(n=>n.type==="qr_code");o.length>0&&(e.push("qr_code:"),o.forEach(n=>{const h=n.props||{},p=`qr_${n.id}`.replace(/-/g,"_"),g=(h.value||"https://esphome.io").replace(/"/g,'\\"'),u=h.ecc||"LOW";e.push(`  - id: ${p}`),e.push(`    value: "${g}"`),e.push(`    ecc: ${u}`)}),e.push(""))},b={id:"qr_code",name:"QR Code",category:"Graphics",defaults:{value:"https://esphome.io",ecc:"LOW",color:"black",bg_color:"white",width:130,height:130},render:L,exportLVGL:v,export:_,onExportComponents:q};export{b as default};
