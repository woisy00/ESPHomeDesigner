const E=(t,r,{getColorStyle:n})=>{const i=r.props||{},l=i.color||"black";let e=i.size||32,f=i.font_size||16,s=i.label_font_size||12;const a=i.unit||"°C",p=i.show_label!==!1,o=i.precision??1;let d=22.5;if(i.fit_icon_to_frame){const y=(r.height||60)-4;e=Math.round(y*.45),f=Math.round(y*.25),s=Math.round(y*.15),e=Math.max(8,e),f=Math.max(8,f),s=Math.max(6,s)}if(!i.is_local_sensor&&r.entity_id&&window.AppState&&window.AppState.entityStates){const h=window.AppState.entityStates[r.entity_id];if(h&&h.state!==void 0){const y=parseFloat(h.state);isNaN(y)||(d=y)}}let _;d<=10?_="F0E4C":d<=25?_="F050F":_="F10C2";const m=983040+parseInt(_.slice(1),16),x=String.fromCodePoint(m);t.style.display="flex",t.style.flexDirection="column",t.style.alignItems="center",t.style.justifyContent="center",t.style.color=n(l);const c=document.createElement("div");c.textContent=x,c.style.fontSize=`${e}px`,c.style.fontFamily="MDI, system-ui, -apple-system, BlinkMacSystemFont, sans-serif",c.style.lineHeight="1",t.appendChild(c);const u=document.createElement("div");u.style.fontSize=`${f}px`,u.style.fontWeight="500",u.style.marginTop="2px";let $=d;if(a==="°F"&&($=d*9/5+32),u.textContent=$.toFixed(o)+a,t.appendChild(u),p){const h=document.createElement("div");h.style.fontSize=`${s}px`,h.style.opacity="0.7",h.style.marginTop="1px",h.textContent="Temperature",t.appendChild(h)}},M={id:"ondevice_temperature",name:"Temperature",category:"SHT4x",supportedModes:["lvgl","direct"],defaults:{width:60,height:60,size:32,font_size:16,label_font_size:10,color:"black",unit:"°C",show_label:!0,precision:1,fit_icon_to_frame:!0,is_local_sensor:!0},render:E,exportOpenDisplay:(t,{layout:r,page:n})=>{const i=t.props||{},l=(t.entity_id||i.weather_entity||"sensor.temperature").trim(),e=i.size||32,f=i.font_size||16,s=i.color||"black",a=i.unit||"°C";let p=22.5;if(window.AppState&&window.AppState.entityStates&&l){const _=window.AppState.entityStates[l];_&&_.state&&(p=parseFloat(_.state))}let o="thermometer";p<=10?o="thermometer-low":p>=30&&(o="thermometer-high");let d=p;return a==="°F"&&(d=p*9/5+32),[{type:"draw_icon",value:o,x:Math.round(t.x+t.width/2),y:Math.round(t.y),size:e,color:s},{type:"draw_text",text:`${d.toFixed(1)}${a}`,x:Math.round(t.x+t.width/2),y:Math.round(t.y+e+2),size:f,color:s}]},exportOEPL:(t,{layout:r,page:n})=>{const i=t.props||{},l=(t.entity_id||"sensor.temperature").trim(),e=i.size||32,f=i.font_size||16,s=i.color||"black",a=i.unit||"°C";return[{type:"icon",value:`{% set t = states('${l}') | float %}{% if t <= 10 %}thermometer-low{% elif t >= 30 %}thermometer-high{% else %}thermometer{% endif %}`,x:Math.round(t.x+t.width/2),y:Math.round(t.y),size:e,color:s,anchor:"mt"},{type:"text",value:`{{ states('${l}') }}${a}`,x:Math.round(t.x+t.width/2),y:Math.round(t.y+e+2),size:f,color:s,align:"center",anchor:"mt"}]},exportLVGL:(t,{common:r,convertColor:n,getLVGLFont:i,profile:l})=>{const e=t.props||{},f=e.is_local_sensor===!0||e.is_local_sensor!==!1&&!t.entity_id;let s=(t.entity_id||"").replace(/[^a-zA-Z0-9_]/g,"_");f&&l.features&&(s=l.features.sht4x?"sht4x_temperature":l.features.sht3x?"sht3x_temperature":l.features.shtc3?"shtc3_temperature":"onboard_temperature"),s||(s="onboard_temperature");const a=n(e.color||"black"),p=parseInt(e.size||32,10),o=parseInt(e.font_size||16,10),d=parseInt(e.label_font_size||10,10),_=e.unit||"°C",m=l.features&&(l.features.sht4x||l.features.sht3x||l.features.shtc3),x=f&&m&&s!=="onboard_temperature"||!!t.entity_id;if(!x)return{obj:{...r,bg_opa:"transp",border_width:0,widgets:[{label:{width:parseInt(e.size||32,10)+10,height:parseInt(e.size||32,10)+4,align:"top_mid",text:"\\U000F050F",text_font:i("Material Design Icons",parseInt(e.size||32,10),400),text_color:n(e.color||"black")}},{label:{width:"100%",height:parseInt(e.font_size||16,10)+6,align:"top_mid",y:parseInt(e.size||32,10)+2,text:`--${e.unit||"°C"}`,text_font:i("Roboto",parseInt(e.font_size||16,10),400),text_color:n(e.color||"black"),text_align:"center"}},...e.show_label?[{label:{width:"100%",height:parseInt(e.label_font_size||10,10)+4,align:"bottom_mid",text:'"Temperature"',text_font:i("Roboto",parseInt(e.label_font_size||10,10),400),text_color:n(e.color||"black"),text_align:"center",opa:"70%"}}]:[]]}};let c=`!lambda |-
`;x&&(c+=`          if (id(${s}).has_state()) {
`,c+=`            float t = id(${s}).state;
`,c+=`            if (t <= 10) return "\\U000F0E4C";
`,c+=`            if (t <= 25) return "\\U000F050F";
`,c+=`            return "\\U000F10C2";
`,c+=`          }
`,c+='          return "\\U000F050F";');let u=`!lambda |-
`;if(x){u+=`          if (id(${s}).has_state()) {
`;let h=`id(${s}).state`;_==="°F"&&(h=`(id(${s}).state * 9.0 / 5.0) + 32.0`),u+=`            return str_sprintf("%.1f${_}", ${h}).c_str();
`,u+=`          }
`,u+=`          return "--${_}";`}const $=[{label:{width:p+10,height:p+4,align:"top_mid",text:c,text_font:i("Material Design Icons",p,400),text_color:a}},{label:{width:"100%",height:o+6,align:"top_mid",y:p+2,text:u,text_font:i("Roboto",o,400),text_color:a,text_align:"center"}}];return e.show_label&&$.push({label:{width:"100%",height:d+4,align:"bottom_mid",text:'"Temperature"',text_font:i("Roboto",d,400),text_color:a,text_align:"center",opa:"70%"}}),{obj:{...r,bg_opa:"transp",border_width:0,widgets:$}}},collectRequirements:(t,r)=>{const{trackIcon:n,addFont:i}=r,l=t.props||{},e=parseInt(l.size||32,10),f=parseInt(l.font_size||16,10),s=parseInt(l.label_font_size||10,10);i("Material Design Icons",400,e),i("Roboto",400,f),l.show_label&&i("Roboto",400,s),["F0E4C","F050F","F10C2"].forEach(a=>n(a,e))},export:(t,r)=>{const{lines:n,getColorConst:i,getCondProps:l,getConditionCheck:e,addFont:f,profile:s}=r,a=t.props||{},p=i(a.color||"black"),o=a.unit||"°C",d=a.size||32,_=a.font_size||16,m=f("Material Design Icons",400,d),x=f("Roboto",400,_),c=a.is_local_sensor===!0||a.is_local_sensor!==!1&&!t.entity_id;let u=(t.entity_id||"").replace(/[^a-zA-Z0-9_]/g,"_");c&&s.features&&(u=s.features.sht4x?"sht4x_temperature":s.features.sht3x?"sht3x_temperature":s.features.shtc3?"shtc3_temperature":"onboard_temperature"),u||(u="onboard_temperature"),n.push(`        // widget:ondevice_temperature id:${t.id} type:ondevice_temperature x:${t.x} y:${t.y} w:${t.width} h:${t.height} unit:${o} local:${c} ent:${t.entity_id||""} ${l(t)}`);const $=e(t);$&&n.push(`        ${$}`);const h=`${t.x} + ${t.width} / 2`,y=a.label_font_size||10,T=d+2+_+(a.show_label?1+y:0),z=Math.max(0,Math.round((t.height-T)/2)),b=`${t.y} + ${z} + ${Math.round(d/2)}`,S=`${t.y} + ${z} + ${d} + 2`,C=`${t.y} + ${z} + ${d} + 2 + ${_} + 1`,F=s.features&&(s.features.sht4x||s.features.sht3x||s.features.shtc3),I=c&&F&&u!=="onboard_temperature"||!!t.entity_id;if(I?(n.push(`        if (id(${u}).has_state()) {`),n.push(`          if (id(${u}).state <= 10) {`),n.push(`            it.printf(${h}, ${b}, id(${m}), ${p}, TextAlign::CENTER, "\\U000F0E4C");`),n.push(`          } else if (id(${u}).state <= 25) {`),n.push(`            it.printf(${h}, ${b}, id(${m}), ${p}, TextAlign::CENTER, "\\U000F050F");`),n.push("          } else {"),n.push(`            it.printf(${h}, ${b}, id(${m}), ${p}, TextAlign::CENTER, "\\U000F10C2");`),n.push("          }"),n.push("        } else {"),n.push(`          it.printf(${h}, ${b}, id(${m}), ${p}, TextAlign::CENTER, "\\U000F050F");`),n.push("        }")):n.push(`          it.printf(${h}, ${b}, id(${m}), ${p}, TextAlign::CENTER, "\\U000F050F");`),I){let g=`id(${u}).state`;o==="°F"&&(g=`(id(${u}).state * 9.0 / 5.0) + 32.0`),n.push(`        if (id(${u}).has_state()) {`),n.push(`          it.printf(${h}, ${S}, id(${x}), ${p}, TextAlign::TOP_CENTER, "%.1f${o}", ${g});`),n.push("        } else {"),n.push(`          it.printf(${h}, ${S}, id(${x}), ${p}, TextAlign::TOP_CENTER, "--${o}");`),n.push("        }")}else n.push(`          it.printf(${h}, ${S}, id(${x}), ${p}, TextAlign::TOP_CENTER, "--${o}");`);if(a.show_label){const g=f("Roboto",400,y);n.push(`        it.printf(${h}, ${C}, id(${g}), ${p}, TextAlign::TOP_CENTER, "Temperature");`)}$&&n.push("        }")},onExportNumericSensors:t=>{const{lines:r,widgets:n,isLvgl:i,pendingTriggers:l,profile:e}=t;if(!n)return;let f=!1;for(const s of n){if(s.type!=="ondevice_temperature")continue;const a=s.props||{},p=a.is_local_sensor===!0||a.is_local_sensor!==!1&&!s.entity_id;let o=(s.entity_id||"").trim();if(p?(f=!0,e.features?o=e.features.sht4x?"sht4x_temperature":e.features.sht3x?"sht3x_temperature":e.features.shtc3?"shtc3_temperature":"onboard_temperature":o="onboard_temperature"):o&&(o.includes(".")||(o=`sensor.${o}`)),!!o&&(i&&l&&(l.has(o)||l.set(o,new Set),l.get(o).add(`- lvgl.widget.refresh: ${s.id}`)),!p&&o.startsWith("sensor."))){const d=o.replace(/[^a-zA-Z0-9_]/g,"_");t.seenSensorIds&&!t.seenSensorIds.has(d)&&(t.seenSensorIds.size===0&&(r.push(""),r.push("# External Temperature Sensors")),t.seenSensorIds.add(d),r.push("- platform: homeassistant"),r.push(`  id: ${d}`),r.push(`  entity_id: ${o}`),r.push("  internal: true"))}}if(f&&e.features){const s=!!e.features.sht4x,a=!!e.features.sht3x,p=!!e.features.shtc3;if(s||a||p){const o=s?"sht4x_sensor":a?"sht3x_sensor":"shtc3_sensor",d=s?"sht4x":a?"sht3xd":"shtcx",_=s?"sht4x_temperature":a?"sht3x_temperature":"shtc3_temperature",m=t.mainLines||r;t.seenSensorIds&&t.seenSensorIds.has(o)||t.seenSensorIds&&t.seenSensorIds.has(_)||m.some(c=>c.includes(`id: ${o}`))||(t.seenSensorIds&&(t.seenSensorIds.add(o),t.seenSensorIds.add(_)),r.push(`- platform: ${d}`,`  id: ${o}`),r.push("  temperature:",`    id: ${_}`,"    internal: true"),r.push("  update_interval: 60s"),d==="shtcx"&&!r.some(c=>c.includes("address: 0x70"))&&(r.push("    address: 0x70"),r.push("    i2c_id: bus_a")),d==="sht3xd"&&!r.some(c=>c.includes("address: 0x44"))&&r.push("    address: 0x44"))}}}};export{M as default};
