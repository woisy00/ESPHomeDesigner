const S=(t,o,{getColorStyle:s})=>{const l=o.props||{},c=l.color||"black";let n=l.size||32,p=l.font_size||16,e=l.label_font_size||12;const a=l.unit||"%",d=l.show_label!==!1,i=l.precision??0;let r=45;if(l.fit_icon_to_frame){const _=(o.height||60)-4;n=Math.round(_*.45),p=Math.round(_*.25),e=Math.round(_*.15),n=Math.max(8,n),p=Math.max(8,p),e=Math.max(6,e)}if(!l.is_local_sensor&&o.entity_id&&window.AppState&&window.AppState.entityStates){const f=window.AppState.entityStates[o.entity_id];if(f&&f.state!==void 0){const _=parseFloat(f.state);isNaN(_)||(r=_)}}let $;r<=30?$="F0E7A":r<=60?$="F058E":$="F058C";const y=983040+parseInt($.slice(1),16),x=String.fromCodePoint(y);t.style.display="flex",t.style.flexDirection="column",t.style.alignItems="center",t.style.justifyContent="center",t.style.color=s(c);const h=document.createElement("div");h.textContent=x,h.style.fontSize=`${n}px`,h.style.fontFamily="MDI, system-ui, -apple-system, BlinkMacSystemFont, sans-serif",h.style.lineHeight="1",t.appendChild(h);const u=document.createElement("div");if(u.style.fontSize=`${p}px`,u.style.fontWeight="500",u.style.marginTop="2px",u.textContent=r.toFixed(i)+a,t.appendChild(u),d){const f=document.createElement("div");f.style.fontSize=`${e}px`,f.style.opacity="0.7",f.style.marginTop="1px",f.textContent="Humidity",t.appendChild(f)}},z={id:"ondevice_humidity",name:"Humidity",category:"SHT4x",defaults:{width:60,height:60,size:32,font_size:16,label_font_size:10,color:"black",unit:"%",show_label:!0,precision:0,fit_icon_to_frame:!0,is_local_sensor:!0},render:S,exportLVGL:(t,{common:o,convertColor:s,getLVGLFont:l,profile:c})=>{const n=t.props||{},p=n.is_local_sensor===!0||n.is_local_sensor!==!1&&!t.entity_id;let e=(t.entity_id||"").replace(/[^a-zA-Z0-9_]/g,"_");p&&c.features&&(e=c.features.sht4x?"sht4x_humidity":c.features.sht3x?"sht3x_humidity":c.features.shtc3?"shtc3_humidity":"onboard_humidity"),e||(e="onboard_humidity");const a=s(n.color||"black"),d=parseInt(n.size||32,10),i=parseInt(n.font_size||16,10),r=parseInt(n.label_font_size||10,10),$=n.unit||"%",y=c.features&&(c.features.sht4x||c.features.sht3x||c.features.shtc3);if(!(p&&y&&e!=="onboard_humidity"||!!t.entity_id))return{obj:{...o,bg_opa:"transp",border_width:0,widgets:[{label:{width:d+10,height:d+4,align:"top_mid",text:"\\U000F058E",text_font:l("Material Design Icons",d,400),text_color:a}},{label:{width:"100%",height:i+6,align:"top_mid",y:d+2,text:`--${$}`,text_font:l("Roboto",i,400),text_color:a,text_align:"center"}},...n.show_label?[{label:{width:"100%",height:r+4,align:"bottom_mid",text:'"Humidity"',text_font:l("Roboto",r,400),text_color:a,text_align:"center",opa:"70%"}}]:[]]}};let h=`!lambda |-
`;h+=`          if (id(${e}).has_state()) {
`,h+=`            float h = id(${e}).state;
`,h+=`            if (h <= 30) return "\\U000F0E7A";
`,h+=`            if (h <= 60) return "\\U000F058E";
`,h+=`            return "\\U000F058C";
`,h+=`          }
`,h+='          return "\\U000F058E";';let u=`!lambda |-
`;u+=`          if (id(${e}).has_state()) {
`,u+=`            return str_sprintf("%.0f${$}", id(${e}).state).c_str();
`,u+=`          }
`,u+=`          return "--${$}";`;const f=[{label:{width:d+10,height:d+4,align:"top_mid",text:h,text_font:l("Material Design Icons",d,400),text_color:a}},{label:{width:"100%",height:i+6,align:"top_mid",y:d+2,text:u,text_font:l("Roboto",i,400),text_color:a,text_align:"center"}}];return n.show_label&&f.push({label:{width:"100%",height:r+4,align:"bottom_mid",text:'"Humidity"',text_font:l("Roboto",r,400),text_color:a,text_align:"center",opa:"70%"}}),{obj:{...o,bg_opa:"transp",border_width:0,widgets:f}}},collectRequirements:(t,o)=>{const{trackIcon:s,addFont:l}=o,c=t.props||{},n=parseInt(c.size||32,10),p=parseInt(c.font_size||16,10),e=parseInt(c.label_font_size||10,10);l("Material Design Icons",400,n),l("Roboto",400,p),c.show_label&&l("Roboto",400,e),["F0E7A","F058E","F058C"].forEach(a=>s(a,n))},export:(t,o)=>{const{lines:s,getColorConst:l,getCondProps:c,getConditionCheck:n,addFont:p,profile:e}=o,a=t.props||{},d=l(a.color||"black"),i=a.unit||"%",r=a.size||32,$=a.font_size||16,y=p("Material Design Icons",400,r),x=p("Roboto",400,$),h=a.is_local_sensor===!0||a.is_local_sensor!==!1&&!t.entity_id;let u=(t.entity_id||"").replace(/[^a-zA-Z0-9_]/g,"_");h&&e.features&&(u=e.features.sht4x?"sht4x_humidity":e.features.sht3x?"sht3x_humidity":e.features.shtc3?"shtc3_humidity":"onboard_humidity"),u||(u="onboard_humidity"),s.push(`        // widget:ondevice_humidity id:${t.id} type:ondevice_humidity x:${t.x} y:${t.y} w:${t.width} h:${t.height} unit:${i} local:${h} ent:${t.entity_id||""} ${c(t)}`);const f=n(t);f&&s.push(`        ${f}`);const _=`${t.x} + ${t.width} / 2`,m=`${t.y} + ${Math.round(r/2)}`,g=e.features&&(e.features.sht4x||e.features.sht3x||e.features.shtc3),b=h&&g||!!t.entity_id;if(b?(s.push(`        if (id(${u}).has_state()) {`),s.push(`          if (id(${u}).state <= 30) {`),s.push(`            it.printf(${_}, ${m}, id(${y}), ${d}, TextAlign::CENTER, "\\U000F0E7A");`),s.push(`          } else if (id(${u}).state <= 60) {`),s.push(`            it.printf(${_}, ${m}, id(${y}), ${d}, TextAlign::CENTER, "\\U000F058E");`),s.push("          } else {"),s.push(`            it.printf(${_}, ${m}, id(${y}), ${d}, TextAlign::CENTER, "\\U000F058C");`),s.push("          }"),s.push("        } else {"),s.push(`          it.printf(${_}, ${m}, id(${y}), ${d}, TextAlign::CENTER, "\\U000F058E");`),s.push("        }")):(s.push(`          it.printf(${_}, ${m}, id(${y}), ${d}, TextAlign::CENTER, "\\U000F058E");`),s.push(`          it.printf(${_}, ${t.y} + ${r+5}, id(${x}), ${d}, TextAlign::TOP_CENTER, "--${i}");`)),b?(s.push(`        if (id(${u}).has_state()) {`),s.push(`          it.printf(${_}, ${t.y} + ${r+5}, id(${x}), ${d}, TextAlign::TOP_CENTER, "%.0f${i}", id(${u}).state);`),s.push("        } else {"),s.push(`          it.printf(${_}, ${t.y} + ${r+5}, id(${x}), ${d}, TextAlign::TOP_CENTER, "--${i}");`),s.push("        }")):s.push(`          it.printf(${_}, ${t.y} + ${r+5}, id(${x}), ${d}, TextAlign::TOP_CENTER, "--${i}");`),a.show_label){const E=p("Roboto",400,a.label_font_size||10);s.push(`        it.printf(${_}, ${t.y} + ${r+$+8}, id(${E}), ${d}, TextAlign::TOP_CENTER, "Humidity");`)}f&&s.push("        }")},onExportNumericSensors:t=>{const{lines:o,widgets:s,isLvgl:l,pendingTriggers:c,profile:n}=t;if(!s)return;let p=!1;for(const e of s){if(e.type!=="ondevice_humidity")continue;const a=e.props||{},d=a.is_local_sensor===!0||a.is_local_sensor!==!1&&!e.entity_id;let i=(e.entity_id||"").trim();if(d?(p=!0,n.features?i=n.features.sht4x?"sht4x_humidity":n.features.sht3x?"sht3x_humidity":n.features.shtc3?"shtc3_humidity":"onboard_humidity":i="onboard_humidity"):i&&(i.includes(".")||(i=`sensor.${i}`)),!!i&&i&&(l&&c&&(c.has(i)||c.set(i,new Set),c.get(i).add(`- lvgl.widget.refresh: ${e.id}`)),!d&&i.startsWith("sensor."))){const r=i.replace(/[^a-zA-Z0-9_]/g,"_");t.seenSensorIds&&!t.seenSensorIds.has(r)&&(t.seenSensorIds.size===0&&(o.push(""),o.push("# External Humidity Sensors")),t.seenSensorIds.add(r),o.push("- platform: homeassistant"),o.push(`  id: ${r}`),o.push(`  entity_id: ${i}`),o.push("  internal: true"))}}if(p&&n.features){const e=!!n.features.sht4x,a=!!n.features.sht3x,d=!!n.features.shtc3;if(e||a||d){const i=e?"sht4x_sensor":a?"sht3x_sensor":"shtc3_sensor",r=e?"sht4x":a?"sht3xd":"shtcx",$=e?"sht4x_humidity":a?"sht3x_humidity":"shtc3_humidity",y=t.mainLines||o;t.seenSensorIds&&t.seenSensorIds.has(i)||y.some(h=>h.includes(`id: ${i}`))||(t.seenSensorIds&&(t.seenSensorIds.add(i),t.seenSensorIds.add($)),o.push(`- platform: ${r}`,`  id: ${i}`),o.push("  humidity:",`    id: ${$}`,"    internal: true"),o.push("  update_interval: 60s"),r==="shtcx"&&!o.some(h=>h.includes("address: 0x70"))&&(o.push("    address: 0x70"),o.push("    i2c_id: bus_a")),r==="sht3xd"&&!o.some(h=>h.includes("address: 0x44"))&&o.push("    address: 0x44"))}}}};export{z as default};
