const m=()=>window.location.protocol==="file:"||!window.location.hostname,u=(e,i,s)=>{const{getColorStyle:f,selected:y,profile:a}=s||{},n=i.props||{},p=(n.url||"").trim(),r=(n.path||"").replace(/^"|"$/g,"").trim(),c=!!n.invert,h=a?.displayType||"binary";let d="";if(c&&(d+="invert(1) "),h==="binary"?d+="grayscale(100%) contrast(1.5) ":h==="grayscale"&&(d+="grayscale(100%) "),e.style.boxSizing="border-box",e.style.backgroundColor="#f5f5f5",e.style.display="flex",e.style.alignItems="center",e.style.justifyContent="center",e.style.overflow="hidden",e.style.color="#666",e.innerText="",e.style.backgroundImage="",r){const t=r.split(/[/\\]/).pop()||r;e.innerHTML="";const g=document.createElement("img");g.style.maxWidth="100%",g.style.maxHeight="100%",g.style.objectFit="contain",g.draggable=!1,d&&(g.style.filter=d.trim()),g.onerror=()=>{const l=m()?"<br/><span style='color:#e67e22;font-size:8px;'>‚ö†Ô∏è Offline mode - preview in HA</span>":"";e.innerHTML="<div style='text-align:center;color:#666;font-size:11px;padding:8px;line-height:1.4;'>üñºÔ∏è<br/><strong>"+t+"</strong><br/><span style='color:#999;font-size:9px;'>"+(c?"(inverted) ":"")+i.width+"√ó"+i.height+"px</span>"+l+"</div>"},g.onload=()=>{if(y){const l=document.createElement("div");l.style.position="absolute",l.style.bottom="2px",l.style.right="2px",l.style.background="rgba(0,0,0,0.6)",l.style.color="white",l.style.padding="2px 4px",l.style.fontSize="8px",l.style.borderRadius="2px",l.textContent=t+" ‚Ä¢ "+i.width+"√ó"+i.height+"px",e.appendChild(l)}};let o;m()?r.match(/^[A-Za-z]:\\/)?o="file:///"+r.replace(/\\/g,"/"):r.startsWith("/config/")?o=null:o=r:o="/api/esphome_designer/image_proxy?path="+encodeURIComponent(r),o?(g.src=o,e.appendChild(g)):e.innerHTML="<div style='text-align:center;color:#666;font-size:11px;padding:8px;line-height:1.4;'>üñºÔ∏è<br/><strong>"+t+"</strong><br/><span style='color:#999;font-size:9px;'>"+(c?"(inverted) ":"")+i.width+"√ó"+i.height+"px</span><br/><span style='color:#e67e22;font-size:8px;'>‚ö†Ô∏è Preview available in Home Assistant</span></div>";return}if(p){const t=document.createElement("img");t.style.maxWidth="100%",t.style.maxHeight="100%",t.style.objectFit="contain",t.draggable=!1,d&&(t.style.filter=d.trim()),t.onerror=()=>{e.innerHTML="<div style='text-align:center;color:#666;font-size:11px;padding:8px;line-height:1.4;'>üñºÔ∏è<br/><strong>Image</strong><br/><span style='color:#999;font-size:9px;'>"+(c?"(inverted) ":"")+"Load Failed</span></div>"},t.onload=()=>{if(y){const g=p.split("/").pop(),o=document.createElement("div");o.style.position="absolute",o.style.bottom="2px",o.style.right="2px",o.style.background="rgba(0,0,0,0.6)",o.style.color="white",o.style.padding="2px 4px",o.style.fontSize="8px",o.style.borderRadius="2px",o.textContent=g,e.appendChild(o)}},t.src=p,e.appendChild(t)}else{const t=document.createElement("div");t.style.textAlign="center",t.style.color="#aaa",t.style.fontSize="11px",t.innerHTML="üñºÔ∏è<br/>Image Widget<br/><span style='font-size:9px;color:#ccc;'>Enter path in properties ‚Üí</span>",e.appendChild(t)}},x=e=>{const s=((e.props||{}).path||"").replace(/^"|"$/g,"").trim();return s?`img_${s.replace(/[^a-zA-Z0-9]/g,"_").replace(/^_+|_+$/g,"").replace(/_+/g,"_")}_${e.width}x${e.height}`:`img_${e.id.replace(/-/g,"_")}`},b=(e,i)=>{const{lines:s,getCondProps:f,getConditionCheck:y,profile:a}=i,n=e.props||{},p=(n.path||"").replace(/^"|"$/g,"").trim(),r=!!n.invert;if(!p)return;const c=x(e);s.push(`        // widget:image id:${e.id} type:image x:${e.x} y:${e.y} w:${e.width} h:${e.height} path:"${p}" invert:${r} ${f(e)}`);const h=y(e);h&&s.push(`        ${h}`),a?.features?.lcd||a?.name&&(a.name.includes("6-Color")||a.name.includes("Color"))?s.push(`        it.image(${e.x}, ${e.y}, id(${c}));`):r?s.push(`        it.image(${e.x}, ${e.y}, id(${c}), color_off, color_on);`):s.push(`        it.image(${e.x}, ${e.y}, id(${c}), color_on, color_off);`),h&&s.push("        }")},$=e=>{const{lines:i,widgets:s,profile:f}=e,y=s.filter(a=>a.type==="image");if(y.length>0){const a=new Set,n=[];y.forEach(p=>{const c=((p.props||{}).path||"").replace(/^"|"$/g,"").trim();if(!c)return;const h=x(p);if(a.has(h))return;a.add(h);const d=f.features?.lcd||f.name&&(f.name.includes("6-Color")||f.name.includes("Color")),t=d?"RGB565":"BINARY";n.push(`  - file: "${c}"`),n.push(`    id: ${h}`),n.push(`    type: ${t}`),n.push(`    resize: ${p.width}x${p.height}`),d||n.push("    dither: FLOYDSTEINBERG")}),n.length>0&&(i.push("image:"),i.push(...n),i.push(""))}},v={id:"image",name:"Image",category:"Graphics",defaults:{path:"",url:"",invert:!1,size:"native"},render:u,export:b,onExportComponents:$};export{v as default};
