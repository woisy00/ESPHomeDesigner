const B=(t,r,{getColorStyle:e})=>{const a=r.props||{},_=a.color||"black",o=a.icon_size||20,y=a.font_size||14,i=a.border_thickness||0;t.style.display="flex",t.style.alignItems="center",t.style.justifyContent="space-around",t.style.padding="0 10px",t.style.boxSizing="border-box";let n=e(_);if(t.style.overflow="hidden",a.show_background){const l=e(a.background_color||"white");t.style.backgroundColor=l,t.style.borderRadius=(a.border_radius||8)+"px",i>0?t.style.border=`${i}px solid ${e(a.border_color||"white")}`:t.style.border="none",n==="#000000"&&l==="#000000"&&(n="#ffffff"),(!a.background_color||a.background_color==="transparent")&&(t.style.border="1px dashed #444")}else t.style.backgroundColor="transparent",t.style.borderRadius="0",t.style.border="none";t.style.color=n;const u=l=>{if(!window.AppState||!window.AppState.entityStates)return null;for(const c of l)if(c&&window.AppState.entityStates[c])return window.AppState.entityStates[c].state;return null},s=[];if(a.show_wifi){const l=u([a.wifi_entity,"wifi_signal_dbm","sensor.wifi_signal"]);s.push({type:"wifi",icon:"F0928",val:l!==null?Math.round(l)+"dB":"-65dB"})}if(a.show_temperature){const l=u([a.temp_entity,"sht4x_temperature","sht3x_temperature","shtc3_temperature","sensor.temperature"]),c=a.temp_unit||"°C";let f=l!==null?parseFloat(l):23.5;c==="°F"&&(f=f*9/5+32),s.push({type:"temp",icon:"F050F",val:f.toFixed(1)+c})}if(a.show_humidity){const l=u([a.hum_entity,"sht4x_humidity","shtc3_humidity","sensor.humidity"]);s.push({type:"hum",icon:"F058E",val:l!==null?Math.round(l)+"%":"45%"})}if(a.show_battery){const l=u([a.bat_entity,"battery_level","sensor.battery_level"]);s.push({type:"bat",icon:"F0079",val:l!==null?Math.round(l)+"%":"85%"})}t.innerHTML="",s.forEach(l=>{const c=document.createElement("div");c.style.display="flex",c.style.alignItems="center",c.style.gap="6px";const f=document.createElement("span"),$=parseInt(l.icon,16);f.innerText=String.fromCodePoint($),f.style.fontFamily="'Material Design Icons', 'MDI', system-ui, -sans-serif",f.style.fontSize=o+"px",f.style.lineHeight="1";const d=document.createElement("span");d.innerText=l.val,d.style.fontSize=y+"px",d.style.fontFamily="Roboto, system-ui, -sans-serif",d.style.fontWeight="500",d.style.whiteSpace="nowrap",c.appendChild(f),c.appendChild(d),t.appendChild(c)})},O=(t,r)=>{const{lines:e,addFont:a,getColorConst:_,addDitherMask:o,getCondProps:y,getConditionCheck:i,profile:n,isEpaper:u}=r,s=t.props||{},l=w=>w==="gray"||w==="grey"?"#808080":w,c=parseInt(s.icon_size||20,10),f=parseInt(s.font_size||14,10),$=l(s.color||"white"),d=_($),E=s.show_wifi!==!1,h=s.show_temperature!==!1,x=s.show_humidity!==!1,F=s.show_battery!==!1,v=s.show_background!==!1,k=_(l(s.background_color||"black")),R=parseInt(s.border_radius||8,10),p=parseInt(s.border_thickness||0,10),L=_(l(s.border_color||"white")),N=(s.wifi_entity||"wifi_signal_dbm").replace(/[^a-zA-Z0-9_]/g,"_"),M=(s.bat_entity||"battery_level").replace(/[^a-zA-Z0-9_]/g,"_"),U=(s.hum_entity||(n.features?.sht4x?"sht4x_humidity":n.features?.sht3x||n.features?.sht3xd?"sht3x_humidity":"shtc3_humidity")).replace(/[^a-zA-Z0-9_]/g,"_"),I=(s.temp_entity||(n.features?.sht4x?"sht4x_temperature":n.features?.sht3x||n.features?.sht3xd?"sht3x_temperature":"shtc3_temperature")).replace(/[^a-zA-Z0-9_]/g,"_"),S=a("Material Design Icons",400,c),T=a("Roboto",400,f);e.push(`        // widget:template_sensor_bar id:${t.id} type:template_sensor_bar x:${t.x} y:${t.y} w:${t.width} h:${t.height} wifi:${E} temp:${h} hum:${x} bat:${F} bg:${v} bg_color:${s.background_color||"black"} radius:${R} border:${p} icon_size:${c} font_size:${f} color:${$} wifi_ent:"${s.wifi_entity||""}" temp_ent:"${s.temp_entity||""}" temp_unit:${s.temp_unit||"°C"} hum_ent:"${s.hum_entity||""}" bat_ent:"${s.bat_entity||""}" ${y(t)}`);const A=i(t);A&&e.push(`        ${A}`),e.push("        {"),v?R>0?(e.push("          auto draw_filled_rrect = [&](int x, int y, int w, int h, int r, auto c) {"),e.push("            it.filled_rectangle(x + r, y, w - 2 * r, h, c);"),e.push("            it.filled_rectangle(x, y + r, r, h - 2 * r, c);"),e.push("            it.filled_rectangle(x + w - r, y + r, r, h - 2 * r, c);"),e.push("            it.filled_circle(x + r, y + r, r, c);"),e.push("            it.filled_circle(x + w - r - 1, y + r, r, c);"),e.push("            it.filled_circle(x + r, y + h - r - 1, r, c);"),e.push("            it.filled_circle(x + w - r - 1, y + h - r - 1, r, c);"),e.push("          };"),p>0?(e.push(`          draw_filled_rrect(${t.x}, ${t.y}, ${t.width}, ${t.height}, ${R}, ${L});`),o(e,s.border_color||"white",u,t.x,t.y,t.width,t.height),e.push(`          draw_filled_rrect(${t.x+p}, ${t.y+p}, ${t.width-2*p}, ${t.height-2*p}, ${Math.max(0,R-p)}, ${k});`),l(s.background_color)!=="black"&&l(s.background_color)!=="#000000"&&o(e,s.background_color||"black",u,t.x+p,t.y+p,t.width-2*p,t.height-2*p)):(e.push(`          draw_filled_rrect(${t.x}, ${t.y}, ${t.width}, ${t.height}, ${R}, ${k});`),o(e,s.background_color||"black",u,t.x,t.y,t.width,t.height))):p>0?(e.push(`          it.filled_rectangle(${t.x}, ${t.y}, ${t.width}, ${t.height}, ${L});`),o(e,s.border_color||"white",u,t.x,t.y,t.width,t.height),e.push(`          it.filled_rectangle(${t.x+p}, ${t.y+p}, ${t.width-2*p}, ${t.height-2*p}, ${k});`),l(s.background_color)!=="black"&&l(s.background_color)!=="#000000"&&o(e,s.background_color||"black",u,t.x+p,t.y+p,t.width-2*p,t.height-2*p)):(e.push(`          it.filled_rectangle(${t.x}, ${t.y}, ${t.width}, ${t.height}, ${k});`),o(e,s.background_color||"black",u,t.x,t.y,t.width,t.height)):p>0&&o(e,s.border_color||"white",u,t.x,t.y,t.width,t.height);let b=d;u&&(s.color==="gray"||s.color==="grey"||s.color==="#808080"||s.color==="#a0a0a0")&&(s.background_color==="black"||s.background_color==="#000000")&&(b="COLOR_WHITE");let C=0;if(E&&C++,h&&C++,x&&C++,F&&C++,C>0){const w=t.width/C;let m=t.x+w/2;const g=t.y+t.height/2;if(E&&(e.push("          {"),e.push('            const char* wifi_icon = "\\U000F092B";'),e.push(`            if (id(${N}).has_state()) {`),e.push(`              float sig = id(${N}).state;`),e.push('              if (sig >= -50) wifi_icon = "\\U000F0928";'),e.push('              else if (sig >= -70) wifi_icon = "\\U000F0925";'),e.push('              else if (sig >= -85) wifi_icon = "\\U000F0922";'),e.push('              else wifi_icon = "\\U000F091F";'),e.push("            }"),e.push(`            it.printf(${Math.round(m)} - 4, ${Math.round(g)}, id(${S}), ${b}, TextAlign::CENTER_RIGHT, "%s", wifi_icon);`),e.push(`            if (id(${N}).has_state()) it.printf(${Math.round(m)} + 4, ${Math.round(g)}, id(${T}), ${b}, TextAlign::CENTER_LEFT, "%.0fdB", id(${N}).state);`),e.push(`            else it.printf(${Math.round(m)} + 4, ${Math.round(g)}, id(${T}), ${b}, TextAlign::CENTER_LEFT, "--dB");`),e.push("          }"),m+=w),h){const z=s.temp_unit||"°C";e.push("          {"),e.push(`            it.printf(${Math.round(m)} - 4, ${Math.round(g)}, id(${S}), ${b}, TextAlign::CENTER_RIGHT, "%s", "\\U000F050F");`),e.push(`            if (id(${I}).has_state() && !std::isnan(id(${I}).state)) {`),z==="°F"||z==="F"?e.push(`              it.printf(${Math.round(m)} + 4, ${Math.round(g)}, id(${T}), ${b}, TextAlign::CENTER_LEFT, "%.1f°F", id(${I}).state * 9.0 / 5.0 + 32.0);`):e.push(`              it.printf(${Math.round(m)} + 4, ${Math.round(g)}, id(${T}), ${b}, TextAlign::CENTER_LEFT, "%.1f°C", id(${I}).state);`),e.push("            } else {"),e.push(`              it.printf(${Math.round(m)} + 4, ${Math.round(g)}, id(${T}), ${b}, TextAlign::CENTER_LEFT, "--${z}");`),e.push("            }"),e.push("          }"),m+=w}x&&(e.push("          {"),e.push(`            it.printf(${Math.round(m)} - 4, ${Math.round(g)}, id(${S}), ${b}, TextAlign::CENTER_RIGHT, "%s", "\\U000F058E");`),e.push(`            if (id(${U}).has_state()) it.printf(${Math.round(m)} + 4, ${Math.round(g)}, id(${T}), ${b}, TextAlign::CENTER_LEFT, "%.0f%%", id(${U}).state);`),e.push(`            else it.printf(${Math.round(m)} + 4, ${Math.round(g)}, id(${T}), ${b}, TextAlign::CENTER_LEFT, "--%%");`),e.push("          }"),m+=w),F&&(e.push("          {"),e.push('            const char* bat_icon = "\\U000F0082";'),e.push(`            float lvl = id(${M}).state;`),e.push('            if (lvl >= 90) bat_icon = "\\U000F0079";'),e.push('            else if (lvl >= 50) bat_icon = "\\U000F007E";'),e.push('            else if (lvl >= 20) bat_icon = "\\U000F007B";'),e.push('            else bat_icon = "\\U000F0083";'),e.push(`            it.printf(${Math.round(m)} - 4, ${Math.round(g)}, id(${S}), ${b}, TextAlign::CENTER_RIGHT, "%s", bat_icon);`),e.push(`            if (id(${M}).has_state()) it.printf(${Math.round(m)} + 4, ${Math.round(g)}, id(${T}), ${b}, TextAlign::CENTER_LEFT, "%.0f%%", id(${M}).state);`),e.push(`            else it.printf(${Math.round(m)} + 4, ${Math.round(g)}, id(${T}), ${b}, TextAlign::CENTER_LEFT, "--%%");`),e.push("          }"))}e.push("        }"),A&&e.push("        }")},Z=t=>{const{lines:r,widgets:e,profile:a}=t,_=e.filter(i=>i.type==="template_sensor_bar");if(_.length===0)return;const o=i=>{if(!i||!i.includes(".")||i.startsWith("text_sensor.")||i.startsWith("binary_sensor.")||r.some(u=>u.includes(`entity_id: ${i}`)))return;const n=i.replace(/[^a-zA-Z0-9_]/g,"_");r.push("- platform: homeassistant"),r.push(`  id: ${n}`),r.push(`  entity_id: ${i}`),r.push("  internal: true")};if(_.forEach(i=>{const n=i.props||{};if(n.show_wifi!==!1){const u=t.mainLines||r;n.wifi_entity?o(n.wifi_entity):!u.some(s=>s.includes("id: wifi_signal_dbm"))&&!r.some(s=>s.includes("id: wifi_signal_dbm"))&&(r.push("- platform: wifi_signal"),r.push("  id: wifi_signal_dbm"),r.push("  internal: true"))}if(n.show_battery!==!1){const u=t.mainLines||r;n.bat_entity?o(n.bat_entity):!u.some(s=>s.includes("id: battery_level"))&&!r.some(s=>s.includes("id: battery_level"))&&(r.push("- platform: template"),r.push("  id: battery_level"),r.push('  name: "Battery Level"'),r.push("  unit_of_measurement: '%'"),r.push("  update_interval: 60s"),r.push("  internal: true"))}n.show_temperature!==!1&&n.temp_entity&&o(n.temp_entity),n.show_humidity!==!1&&n.hum_entity&&o(n.hum_entity)}),_.some(i=>{const n=i.props||{};return n.show_temperature!==!1&&!n.temp_entity||n.show_humidity!==!1&&!n.hum_entity})){const i=a.features?.sht4x,n=a.features?.sht3x||a.features?.sht3xd,u=i?"sht4x_sensor":n?"sht3x_sensor":"shtc3_sensor",s=i?"sht4x":n?"sht3xd":"shtcx",l=i?"sht4x_temperature":n?"sht3x_temperature":"shtc3_temperature",c=t.mainLines||r;if(!c.some(f=>f.includes(`id: ${u}`))&&!c.some(f=>f.includes(`id: ${l}`))){r.push(`- platform: ${s}`),r.push(`  id: ${u}`),(s==="sht3xd"||s==="sht4x")&&r.push("  address: 0x44"),s==="shtcx"&&(r.push("  i2c_id: bus_a"),r.push("  address: 0x70"));const f=_.some(d=>d.props?.show_temperature!==!1&&!d.props?.temp_entity),$=_.some(d=>d.props?.show_humidity!==!1&&!d.props?.hum_entity);if(f){const d=i?"sht4x_temperature":n?"sht3x_temperature":"shtc3_temperature";r.push("  temperature:"),r.push(`    id: ${d}`),r.push("    internal: true")}if($){const d=i?"sht4x_humidity":n?"sht3x_humidity":"shtc3_humidity";r.push("  humidity:"),r.push(`    id: ${d}`),r.push("    internal: true")}r.push("  update_interval: 60s")}}},H=(t,r)=>{const{trackIcon:e,addFont:a}=r,_=t.props||{},o=parseInt(_.icon_size||20,10),y=parseInt(_.font_size||14,10);a("Material Design Icons",400,o),a("Material Design Icons",400,o),a("Roboto",400,y),_.show_wifi!==!1&&["F092B","F091F","F0922","F0925","F0928"].forEach(i=>e(i,o)),_.show_temperature!==!1&&["F050F"].forEach(i=>e(i,o)),_.show_humidity!==!1&&["F058E"].forEach(i=>e(i,o)),_.show_battery!==!1&&["F0082","F0079","F007E","F007B","F0083"].forEach(i=>e(i,o))},W={id:"template_sensor_bar",name:"Sensor Bar",category:"Templates",defaults:{w:355,h:43,show_wifi:!0,show_temperature:!0,show_humidity:!0,show_battery:!0,show_background:!0,background_color:"black",border_radius:8,color:"white",font_size:14,icon_size:20,temp_unit:"°C"},render:B,exportLVGL:(t,{common:r,convertColor:e,getLVGLFont:a,profile:_})=>{const o=t.props||{},y=h=>h==="gray"||h==="grey"?"#808080":h,i=e(y(o.color||"white")),n=parseInt(o.icon_size||20,10),u=parseInt(o.font_size||14,10),s=o.show_wifi!==!1,l=o.show_temperature!==!1,c=o.show_humidity!==!1,f=o.show_battery!==!1,$=a("Material Design Icons",n,400),d=a("Roboto",u,400),E=[];if(s){let h=`!lambda |-
`;h+=`              if (id(wifi_signal_dbm).has_state()) {
`,h+=`                float sig = id(wifi_signal_dbm).state;
`,h+=`                if (sig >= -50) return "\\U000F0928";
`,h+=`                else if (sig >= -70) return "\\U000F0925";
`,h+=`                else if (sig >= -85) return "\\U000F0922";
`,h+=`                else return "\\U000F091F";
`,h+=`              }
`,h+='              return "\\U000F092B";',E.push({obj:{width:"SIZE_CONTENT",height:"SIZE_CONTENT",bg_opa:"TRANSP",border_width:0,layout:"FLEX",flex_flow:"ROW",flex_align_main:"CENTER",flex_align_cross:"CENTER",pad_all:0,widgets:[{label:{text:h,text_font:$,text_color:i}},{label:{text:`!lambda "return id(wifi_signal_dbm).has_state() ? str_sprintf('%.0fdB', id(wifi_signal_dbm).state).c_str() : '--dB';"`,text_font:d,text_color:i,x:4}}]}})}if(l){const h=(o.temp_entity||(_.features?.sht4x?"sht4x_temperature":_.features?.sht3x||_.features?.sht3xd?"sht3x_temperature":"shtc3_temperature")).replace(/[^a-zA-Z0-9_]/g,"_"),x=o.temp_unit||"°C";let F=`id(${h}).state`;x==="°F"&&(F=`(id(${h}).state * 9.0 / 5.0 + 32.0)`),E.push({obj:{width:"SIZE_CONTENT",height:"SIZE_CONTENT",bg_opa:"TRANSP",border_width:0,layout:"FLEX",flex_flow:"ROW",flex_align_main:"CENTER",flex_align_cross:"CENTER",pad_all:0,widgets:[{label:{text:'"\\U000F050F"',text_font:$,text_color:i}},{label:{text:`!lambda "return id(${h}).has_state() ? str_sprintf('%.1f${x}', ${F}).c_str() : '--${x}';"`,text_font:d,text_color:i,x:4}}]}})}if(c){const h=(o.hum_entity||(_.features?.sht4x?"sht4x_humidity":_.features?.sht3x||_.features?.sht3xd?"sht3x_humidity":"shtc3_humidity")).replace(/[^a-zA-Z0-9_]/g,"_");E.push({obj:{width:"SIZE_CONTENT",height:"SIZE_CONTENT",bg_opa:"TRANSP",border_width:0,layout:"FLEX",flex_flow:"ROW",flex_align_main:"CENTER",flex_align_cross:"CENTER",pad_all:0,widgets:[{label:{text:'"\\U000F058E"',text_font:$,text_color:i}},{label:{text:`!lambda "return id(${h}).has_state() ? str_sprintf('%.0f%%', id(${h}).state).c_str() : '--%';"`,text_font:d,text_color:i,x:4}}]}})}if(f){const h=(o.bat_entity||"battery_level").replace(/[^a-zA-Z0-9_]/g,"_");let x=`!lambda |-
`;x+=`              float lvl = id(${h}).state;
`,x+=`              if (lvl >= 90) return "\\U000F0079";
`,x+=`              else if (lvl >= 50) return "\\U000F007E";
`,x+=`              else if (lvl >= 20) return "\\U000F007B";
`,x+='              else return "\\U000F0083";',E.push({obj:{width:"SIZE_CONTENT",height:"SIZE_CONTENT",bg_opa:"TRANSP",border_width:0,layout:"FLEX",flex_flow:"ROW",flex_align_main:"CENTER",flex_align_cross:"CENTER",pad_all:0,widgets:[{label:{text:x,text_font:$,text_color:i}},{label:{text:`!lambda "return id(${h}).has_state() ? str_sprintf('%.0f%%', id(${h}).state).c_str() : '--%';"`,text_font:d,text_color:i,x:4}}]}})}return{obj:{...r,bg_color:o.show_background!==!1?e(y(o.background_color||"black")):"TRANSP",bg_opa:o.show_background!==!1?"COVER":"TRANSP",radius:o.border_radius||8,clip_corner:!0,border_width:o.border_thickness||0,border_color:e(y(o.border_color||"white")),layout:{type:"FLEX",flex_flow:"ROW",flex_align_main:"SPACE_AROUND",flex_align_cross:"CENTER"},widgets:E}}},export:O,onExportNumericSensors:Z,collectRequirements:H};export{W as default};
