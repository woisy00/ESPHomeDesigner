const v=(t,{common:o,convertColor:c})=>{const e=t.props||{};return{qrcode:{...o,text:`"${e.text||e.value||"https://github.com/koosoli/ESPHomeDesigner/"}"`,size:Math.min(t.width,t.height),dark_color:c(e.color),light_color:c(e.bg_color||"white")}}},$=(t,o,c)=>{const e=o.props||{},s=e.value||"https://github.com/koosoli/ESPHomeDesigner/",a=e.color||"theme_auto",r=e.ecc||"LOW";t.style.boxSizing="border-box",t.style.display="flex",t.style.alignItems="flex-start",t.style.justifyContent="flex-start",t.style.overflow="hidden",t.style.padding="0",t.innerHTML="";const l={LOW:"L",MEDIUM:"M",QUARTILE:"Q",HIGH:"H"}[r]||"L";if(typeof qrcode>"u"){t.innerHTML='<div style="color:#999;font-size:10px;text-align:center;">QR Library<br>Loading...</div>';return}try{const i=qrcode(0,l);i.addData(s),i.make();const h=i.getModuleCount(),x=Math.min(o.width,o.height),n=Math.max(1,Math.floor(x/h)),y=n*h,d=document.createElement("canvas");d.width=y,d.height=y,d.style.imageRendering="pixelated";const M=d.getContext("2d"),f=c.getColorStyle(a);M.fillStyle=f;for(let g=0;g<h;g++)for(let p=0;p<h;p++)i.isDark(g,p)&&M.fillRect(p*n,g*n,n,n);t.appendChild(d),o.props._calculatedScale=n}catch(i){t.innerHTML='<div style="color:#c00;font-size:10px;text-align:center;">QR Error:<br>'+i.message+"</div>"}},L=(t,o)=>{const{lines:c,getColorConst:e,addDitherMask:s,sanitize:a,getCondProps:r,getConditionCheck:u,isEpaper:l}=o,i=t.props||{},h=a(i.value||"https://github.com/koosoli/ESPHomeDesigner/"),x=i.ecc||"LOW",n=i.color||"theme_auto",y=e(n),d=`qr_${t.id}`.replace(/-/g,"_"),M=Math.min(t.width,t.height),f=h.length,g=Math.min(177,21+Math.ceil(f/10)*2),p=Math.max(1,Math.floor(M/g));c.push(`        // widget:qr_code id:${t.id} type:qr_code x:${t.x} y:${t.y} w:${t.width} h:${t.height} value:"${h}" scale:${p} ecc:${x} color:${n} ${r(t)}`);const m=u(t);m&&c.push(`        ${m}`),c.push(`        it.qr_code(${t.x}, ${t.y}, id(${d}), ${y}, ${p});`),s(c,n,l,t.x,t.y,t.width,t.height),m&&c.push("        }")},_=t=>{const{lines:o,widgets:c}=t,e=c.filter(s=>s.type==="qr_code");e.length>0&&(o.push("qr_code:"),e.forEach(s=>{const a=s.props||{},r=`qr_${s.id}`.replace(/-/g,"_"),u=(a.value||"https://github.com/koosoli/ESPHomeDesigner/").replace(/"/g,'\\"'),l=a.ecc||"LOW";o.push(`  - id: ${r}`),o.push(`    value: "${u}"`),o.push(`    ecc: ${l}`)}),o.push(""))},b={id:"qr_code",name:"QR Code",category:"Graphics",supportedModes:["lvgl","direct","oepl","opendisplay"],defaults:{value:"https://github.com/koosoli/ESPHomeDesigner/",ecc:"LOW",color:"theme_auto",bg_color:"white",width:130,height:130},render:$,exportOpenDisplay:(t,{layout:o,page:c})=>({type:"draw_qrcode",data:(t.props||{}).value||"https://github.com/koosoli/ESPHomeDesigner/",x:Math.round(t.x),y:Math.round(t.y),w:Math.round(t.width),h:Math.round(t.height)}),exportOEPL:(t,{layout:o,page:c})=>{const s=(t.props||{}).value||"https://github.com/koosoli/ESPHomeDesigner/",a=Math.min(t.width,t.height),r=s.length,u=Math.min(177,21+Math.ceil(r/10)*2),l=Math.max(1,Math.floor(a/u));return{type:"qrcode",data:s,x:Math.round(t.x),y:Math.round(t.y),scale:l}},exportLVGL:v,export:L,onExportComponents:_};export{b as default};
