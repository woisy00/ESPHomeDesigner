const y=(o,i,s,t)=>{var n=(t-90)*Math.PI/180;return{x:o+s*Math.cos(n),y:i+s*Math.sin(n)}},_=(o,i,s,t,n)=>{const a=y(o,i,s,n),c=y(o,i,s,t),d=n-t<=180?"0":"1";return["M",a.x,a.y,"A",s,s,0,d,0,c.x,c.y].join(" ")},S=(o,i,{getColorStyle:s})=>{const t=i.props||{},n=i.width||100,a=i.height||100,c=s(t.color||"black"),d=parseInt(t.thickness||10,10);o.innerHTML="";const r=document.createElementNS("http://www.w3.org/2000/svg","svg");r.setAttribute("width","100%"),r.setAttribute("height","100%"),r.setAttribute("viewBox",`0 0 ${n} ${a}`),r.style.overflow="visible";const m=n/2,f=a/2,w=Math.min(n,a)/2-d/2,l=document.createElementNS("http://www.w3.org/2000/svg","path");l.setAttribute("d",_(m,f,w,-135,135)),l.setAttribute("fill","none"),l.setAttribute("stroke","#eee"),l.setAttribute("stroke-width",d),l.setAttribute("stroke-linecap","round"),r.appendChild(l);const p=t.min||0,h=t.max||100;let u=t.value!==void 0?t.value:50;const b=i.entity_id;if(b&&window.AppState&&window.AppState.entityStates){const e=window.AppState.entityStates[b];if(e&&e.state!==void 0){const v=parseFloat(e.state);isNaN(v)||(u=v)}}u=Math.max(p,Math.min(h,u));const A=270;let g=0;h>p&&(g=(u-p)/(h-p));const x=-135+g*A;if(g>.01){const e=document.createElementNS("http://www.w3.org/2000/svg","path");e.setAttribute("d",_(m,f,w,-135,x)),e.setAttribute("fill","none"),e.setAttribute("stroke",c),e.setAttribute("stroke-width",d),e.setAttribute("stroke-linecap","round"),r.appendChild(e)}if(o.appendChild(r),t.title){const e=document.createElement("div");e.textContent=t.title,e.style.position="absolute",e.style.top="50%",e.style.left="50%",e.style.transform="translate(-50%, -50%)",e.style.fontFamily="Roboto, sans-serif",e.style.fontSize="14px",e.style.color=c,e.style.pointerEvents="none",o.appendChild(e)}},k=(o,{common:i,convertColor:s})=>{const t=o.props||{};let n=t.value||0;return o.entity_id&&(n=`!lambda "return id(${o.entity_id.replace(/[^a-zA-Z0-9_]/g,"_")}).state;"`),{arc:{...i,value:n,min_value:t.min||0,max_value:t.max||100,arc_width:t.thickness,arc_color:s(t.color),indicator:{arc_color:s(t.color)},start_angle:t.start_angle,end_angle:t.end_angle,mode:t.mode,widgets:[{label:{align:"center",text:`"${t.title||""}"`,text_color:s(t.color)}}]}}},M=o=>{const{widgets:i,isLvgl:s,pendingTriggers:t}=o;if(i)for(const n of i){if(n.type!=="lvgl_arc")continue;const a=(n.entity_id||n.props?.entity_id||"").trim();a&&s&&t&&(t.has(a)||t.set(a,new Set),t.get(a).add(`- lvgl.widget.refresh: ${n.id}`))}},E={id:"lvgl_arc",name:"Arc",category:"LVGL",supportedModes:["lvgl"],defaults:{value:50,min:0,max:100,thickness:10,color:"blue",title:"",start_angle:135,end_angle:45,mode:"normal"},render:S,exportLVGL:k,onExportNumericSensors:M};export{E as default};
