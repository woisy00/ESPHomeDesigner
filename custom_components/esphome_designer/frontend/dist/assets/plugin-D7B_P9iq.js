const C=(t,a,r,o="Roboto")=>{const p=o.toLowerCase().includes("mono")||o.toLowerCase().includes("courier")||o.toLowerCase().includes("consolas"),l=r*(p?.6:.52),e=Math.floor(a/l);if(e<=0)return[t];const i=[],c=t.split(`
`);for(const s of c){if(s.length<=e){i.push(s);continue}const h=s.split(/\s+/);let n="";for(const f of h){if(!f)continue;if(f.length>e){n&&(i.push(n.trim()),n="");for(let x=0;x<f.length;x+=e)i.push(f.substring(x,x+e));continue}const u=n?n+" "+f:f;u.length<=e?n=u:(n&&i.push(n.trim()),n=f)}n&&i.push(n.trim())}return i.length>0?i:[""]},k=(t,a,{getColorStyle:r})=>{const o=a.props||{};t.innerHTML="",t.style.display="flex",((h,n=t)=>{h.includes("LEFT")?n.style.justifyContent="flex-start":h.includes("RIGHT")?n.style.justifyContent="flex-end":n.style.justifyContent="center",h.includes("TOP")?n.style.alignItems="flex-start":h.includes("BOTTOM")?n.style.alignItems="flex-end":n.style.alignItems="center"})(o.text_align||"TOP_LEFT");const l=o.font_size||o.value_font_size||20,e=o.font_family||"Roboto",i=o.text||a.title||"Text",c=C(i,a.width||200,l,e),s=document.createElement("div");s.style.color=r(o.color),s.style.fontSize=`${l}px`,s.style.fontFamily=e+", sans-serif",s.style.fontWeight=String(o.font_weight||400),s.style.fontStyle=o.italic?"italic":"normal",s.style.whiteSpace="pre-wrap",s.style.lineHeight=`${l+4}px`,s.style.wordBreak="break-word",s.style.overflowWrap="break-word",s.textContent=c.join(`
`),t.appendChild(s)},A=(t,{common:a,convertColor:r,convertAlign:o,getLVGLFont:p,formatOpacity:l})=>{const e=t.props||{};return{label:{...a,text:`"${e.text||"Text"}"`,text_font:p(e.font_family,e.font_size,e.font_weight,e.italic),text_color:r(e.color||e.text_color),text_align:(o(e.text_align)||"left").replace("top_","").replace("bottom_",""),bg_color:e.bg_color==="transparent"?void 0:r(e.bg_color),opa:l(e.opa)}}},F={id:"text",name:"Text",category:"Core",supportedModes:["lvgl","direct","oepl","opendisplay"],defaults:{text:"Text",font_size:20,font_family:"Roboto",color:"theme_auto",font_weight:400,italic:!1,bpp:1,text_align:"TOP_LEFT",bg_color:"transparent",opa:255},render:k,exportOpenDisplay:(t,{layout:a,page:r})=>{const o=t.props||{},p=o.text||t.title||"Text",l=o.font_size||20,e=o.font_family||"Roboto";let i=o.color||"black";i==="theme_auto"&&(i=a?.darkMode?"white":"black");const c=C(p,t.width||200,l,e);return c.length>1?{type:"multiline",value:c.join(`
`),delimiter:`
`,x:Math.round(t.x),offset_y:l+5,size:l,color:i,font:e?.includes("Mono")?"mononoki.ttf":"ppb.ttf"}:{type:"draw_text",x:Math.round(t.x),y:Math.round(t.y),text:p,size:l,color:i,font:e?.toLowerCase()||"roboto"}},exportLVGL:A,exportOEPL:(t,{layout:a,page:r})=>{const o=t.props||{},p=o.text||t.title||"Text",l=o.font_size||20,e=5;let i=o.color||"black";i==="theme_auto"&&(i=a?.darkMode?"white":"black");const c={type:"text",value:p,x:Math.round(t.x),y:Math.round(t.y),size:l,font:o.font_family?.includes("Mono")?"mononoki.ttf":"ppb.ttf",color:i,align:(o.text_align||"TOP_LEFT").toLowerCase().replace("top_","").replace("bottom_","").replace("_",""),anchor:"lt"};return t.width&&t.width>0&&(c.max_width=Math.round(t.width),c.spacing=e),c},export:(t,a)=>{const{lines:r,getColorConst:o,addFont:p,getAlignX:l,getAlignY:e,getCondProps:i,getConditionCheck:c,Utils:s,isEpaper:h}=a,n=t.props||{},f=n.color||"theme_auto",u=n.font_size||n.value_font_size||20,x=n.font_family||"Roboto",O=p(x,n.font_weight||400,u,n.italic),m=n.text||t.title||"Text",_=n.text_align||"TOP_LEFT",b=h&&s&&s.isGrayColor&&s.isGrayColor(f),$=b?"COLOR_BLACK":o(f),L=m.replace(/[\r\n]+/g,"\\n");r.push(`        // widget:text id:${t.id} type:text x:${t.x} y:${t.y} w:${t.width} h:${t.height} text:"${L.substring(0,50)}${L.length>50?"...":""}" ${i(t)}`);const g=c(t);g&&r.push(`        ${g}`);let y=t.x,T=t.y,d="TextAlign::TOP_LEFT";_.includes("CENTER")?(y=Math.round(t.x+t.width/2),d="TextAlign::TOP_CENTER"):_.includes("RIGHT")&&(y=Math.round(t.x+t.width),d="TextAlign::TOP_RIGHT"),_.includes("BOTTOM")?(T=Math.round(t.y+t.height),d=d.replace("TOP_","BOTTOM_")):_.includes("TOP")||(T=Math.round(t.y+t.height/2),d=d.replace("TOP_","CENTER_")),d==="TextAlign::CENTER_CENTER"&&(d="TextAlign::CENTER");const M=C(m,t.width||200,u,x),z=u+4;let E=T;for(const P of M){const R=P.replace(/"/g,'\\"').replace(/%/g,"%%");r.push(`        it.printf(${y}, ${E}, id(${O}), ${$}, ${d}, "${R}");`),E+=z}b&&r.push(`        apply_grey_dither_to_text(${t.x}, ${t.y}, ${t.width}, ${t.height});`),g&&r.push("        }")}};export{F as default};
