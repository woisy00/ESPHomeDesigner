const S=(t,a,{getColorStyle:i})=>{const n=a.props||{};let l="F0928",e=n.size||24;const d=n.color||"black",h=n.show_dbm!==!1;let s=-45;if(!n.is_local_sensor&&a.entity_id&&window.AppState&&window.AppState.entityStates){const o=window.AppState.entityStates[a.entity_id];if(o&&o.state!==void 0){const f=parseFloat(o.state);isNaN(f)||(s=f)}}if(n.fit_icon_to_frame){const f=Math.max(8,Math.min((a.width||0)-8,(a.height||0)-8));e=Math.round(f)}s>=-50?l="F0928":s>=-60?l="F0925":s>=-75?l="F0922":s>=-100?l="F091F":l="F092B";const r=983040+parseInt(l.slice(1),16),p=String.fromCodePoint(r);if(t.innerText=p,t.style.fontSize=`${e}px`,t.style.color=i(d),t.style.fontFamily="MDI, system-ui, -apple-system, BlinkMacSystemFont, -sans-serif",t.style.lineHeight="1",t.style.display="flex",t.style.alignItems="center",t.style.justifyContent="center",t.style.flexDirection="column",h){const o=document.createElement("div");o.style.fontSize=(n.font_size||12)+"px",o.style.marginTop="2px",o.textContent=Math.round(s)+"dB",t.appendChild(o)}},D=(t,a)=>{const{lines:i,addFont:n,getColorConst:l,addDitherMask:e,getCondProps:d,getConditionCheck:h,isEpaper:s}=a,r=t.props||{},p=(t.entity_id||"").trim(),o=parseInt(r.size||24,10),f=parseInt(r.font_size||12,10),c=r.color||"black",g=r.show_dbm!==!1,_=r.is_local_sensor!==!1,$=l(c),F=n("Material Design Icons",400,o),w=n("Roboto",400,f);let u;_?u="wifi_signal_dbm":u=p?p.replace(/[^a-zA-Z0-9_]/g,"_"):"wifi_signal_dbm",i.push(`        // widget:wifi_signal id:${t.id} type:wifi_signal x:${t.x} y:${t.y} w:${t.width} h:${t.height} entity:${p||"wifi_signal_dbm"} size:${o} font_size:${f} color:${c} show_dbm:${g} local:${_} ${d(t)}`);const m=h(t);m&&i.push(`        ${m}`),i.push("        {");const x=g?o+2+f:o,y=`(${t.height} - ${x}) / 2`,b=`${t.x} + ${t.width} / 2`,z=`${t.y} + ${y}`,I=`${t.y} + ${y} + ${o} + 2`;i.push('          const char* wifi_icon = "\\U000F092B"; // Default: wifi-strength-alert-outline'),i.push(`          if (id(${u}).has_state()) {`),i.push(`            float signal = id(${u}).state;`),i.push("            if (std::isnan(signal)) signal = -100;"),i.push('            if (signal >= -50) wifi_icon = "\\U000F0928";      // wifi-strength-4 (Excellent)'),i.push('            else if (signal >= -60) wifi_icon = "\\U000F0925"; // wifi-strength-3 (Good)'),i.push('            else if (signal >= -75) wifi_icon = "\\U000F0922"; // wifi-strength-2 (Fair)'),i.push('            else if (signal >= -100) wifi_icon = "\\U000F091F"; // wifi-strength-1 (Weak)'),i.push('            else wifi_icon = "\\U000F092B";                    // wifi-strength-alert-outline'),i.push("          }"),i.push(`          it.printf(${b}, ${z}, id(${F}), ${$}, TextAlign::TOP_CENTER, "%s", wifi_icon);`),g&&(i.push(`          if (id(${u}).has_state()) {`),i.push(`            it.printf(${b}, ${I}, id(${w}), ${$}, TextAlign::TOP_CENTER, "%.0fdB", id(${u}).state);`),i.push("          }")),e(i,c,s,t.x,t.y,t.width,t.height),i.push("        }"),m&&i.push("        }")},C={id:"wifi_signal",name:"WiFi Signal",category:"Sensors",defaults:{size:24,font_size:12,color:"black",show_dbm:!0,fit_icon_to_frame:!1,is_local_sensor:!0},render:S,exportLVGL:(t,{common:a,convertColor:i,getLVGLFont:n,formatOpacity:l})=>{const e=t.props||{},d=(t.entity_id||"").trim(),s=e.is_local_sensor!==!1?"wifi_signal_dbm":d?d.replace(/[^a-zA-Z0-9_]/g,"_"):"wifi_signal_dbm",r=i(e.color||"black"),p=parseInt(e.size||24,10),o=parseInt(e.font_size||12,10),f=e.show_dbm!==!1;let c=`!lambda |-
`;c+=`          if (id(${s}).has_state()) {
`,c+=`            float sig = id(${s}).state;
`,c+=`            if (sig >= -50) return "\\U000F0928";
`,c+=`            if (sig >= -60) return "\\U000F0925";
`,c+=`            if (sig >= -75) return "\\U000F0922";
`,c+=`            if (sig >= -100) return "\\U000F091F";
`,c+=`            return "\\U000F092B";
`,c+=`          }
`,c+='          return "\\U000F092B";';const g=[{label:{width:p+10,height:p+4,align:"TOP_MID",text:c,text_font:n("Material Design Icons",p,400),text_color:r}}];if(f){let _=`!lambda |-
`;_+=`          if (id(${s}).has_state()) {
`,_+=`            return str_sprintf("%.0fdB", id(${s}).state).c_str();
`,_+=`          }
`,_+='          return "---dB";',g.push({label:{width:"100%",height:o+4,align:"BOTTOM_MID",y:2,text:_,text_font:n("Roboto",o,400),text_color:r,text_align:"CENTER"}})}return{obj:{...a,bg_opa:"TRANSP",border_width:0,widgets:g}}},collectRequirements:(t,a)=>{const{trackIcon:i,addFont:n}=a,l=t.props||{},e=parseInt(l.size||24,10),d=parseInt(l.font_size||12,10);n("Material Design Icons",400,e),n("Roboto",400,d),["F0928","F0925","F0922","F091F","F092B"].forEach(h=>i(h,e))},export:D,onExportNumericSensors:t=>{const{lines:a,widgets:i}=t;if(!i)return;const n=new Set;let l=!1;for(const e of i){if(e.type!=="wifi_signal")continue;if((e.props||{}).is_local_sensor!==!1){l=!0;continue}let s=(e.entity_id||"").trim();if(s&&(s.includes(".")||(s=`sensor.${s}`),!n.has(s))){n.add(s);const r=s.replace(/[^a-zA-Z0-9_]/g,"_");a.push("- platform: homeassistant",`  id: ${r}`,`  entity_id: ${s}`,"  internal: true")}}l&&!a.some(e=>e.includes("id: wifi_signal_dbm"))&&a.push("- platform: wifi_signal",'  name: "WiFi Signal"',"  id: wifi_signal_dbm","  update_interval: 60s")}};export{C as default};
