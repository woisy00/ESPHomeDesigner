const B=(t,h,{getColorStyle:e})=>{const l=h.props||{},_=l.color||"black",r=l.icon_size||20,g=l.font_size||14,u=l.border_thickness||0;t.style.display="flex",t.style.alignItems="center",t.style.justifyContent="space-around",t.style.padding="0 10px",t.style.boxSizing="border-box";let d=e(_);if(t.style.overflow="hidden",l.show_background){const n=e(l.background_color||"white");t.style.backgroundColor=n,t.style.borderRadius=(l.border_radius||8)+"px",u>0?t.style.border=`${u}px solid ${e(l.border_color||"white")}`:t.style.border="none",d==="#000000"&&n==="#000000"&&(d="#ffffff"),(!l.background_color||l.background_color==="transparent")&&(t.style.border="1px dashed #444")}else t.style.backgroundColor="transparent",t.style.borderRadius="0",t.style.border="none";t.style.color=d;const o=n=>{if(!window.AppState||!window.AppState.entityStates)return null;for(const i of n)if(i&&window.AppState.entityStates[i])return window.AppState.entityStates[i].state;return null},s=[];if(l.show_wifi){const n=o([l.wifi_entity,"wifi_signal_dbm","sensor.wifi_signal"]);s.push({type:"wifi",icon:"F0928",val:n!==null?Math.round(n)+"dB":"-65dB"})}if(l.show_temperature){const n=o([l.temp_entity,"sht4x_temperature","sht3x_temperature","shtc3_temperature","sensor.temperature"]),i=l.temp_unit||"°C";let f=n!==null?parseFloat(n):23.5;i==="°F"&&(f=f*9/5+32),s.push({type:"temp",icon:"F050F",val:f.toFixed(1)+i})}if(l.show_humidity){const n=o([l.hum_entity,"sht4x_humidity","shtc3_humidity","sensor.humidity"]);s.push({type:"hum",icon:"F058E",val:n!==null?Math.round(n)+"%":"45%"})}if(l.show_battery){const n=o([l.bat_entity,"battery_level","sensor.battery_level"]);s.push({type:"bat",icon:"F0079",val:n!==null?Math.round(n)+"%":"85%"})}t.innerHTML="",s.forEach(n=>{const i=document.createElement("div");i.style.display="flex",i.style.alignItems="center",i.style.gap="6px";const f=document.createElement("span"),m=parseInt(n.icon,16);f.innerText=String.fromCodePoint(m),f.style.fontFamily="'Material Design Icons', 'MDI', system-ui, -sans-serif",f.style.fontSize=r+"px",f.style.lineHeight="1";const p=document.createElement("span");p.innerText=n.val,p.style.fontSize=g+"px",p.style.fontFamily="Roboto, system-ui, -sans-serif",p.style.fontWeight="500",p.style.whiteSpace="nowrap",i.appendChild(f),i.appendChild(p),t.appendChild(i)})},Z=(t,h)=>{const{lines:e,addFont:l,getColorConst:_,addDitherMask:r,getCondProps:g,getConditionCheck:u,profile:d,isEpaper:o}=h,s=t.props||{},n=T=>T==="gray"||T==="grey"?"#808080":T,i=parseInt(s.icon_size||20,10),f=parseInt(s.font_size||14,10),m=n(s.color||"white"),p=_(m),w=s.show_wifi!==!1,a=s.show_temperature!==!1,x=s.show_humidity!==!1,I=s.show_battery!==!1,A=s.show_background!==!1,k=_(n(s.background_color||"black")),E=parseInt(s.border_radius||8,10),c=parseInt(s.border_thickness||0,10),U=_(n(s.border_color||"white")),C=(s.wifi_entity||"wifi_signal_dbm").replace(/[^a-zA-Z0-9_]/g,"_"),z=(s.bat_entity||"battery_level").replace(/[^a-zA-Z0-9_]/g,"_"),L=(s.hum_entity||(d.features?.sht4x?"sht4x_humidity":d.features?.sht3x||d.features?.sht3xd?"sht3x_humidity":"shtc3_humidity")).replace(/[^a-zA-Z0-9_]/g,"_"),M=(s.temp_entity||(d.features?.sht4x?"sht4x_temperature":d.features?.sht3x||d.features?.sht3xd?"sht3x_temperature":"shtc3_temperature")).replace(/[^a-zA-Z0-9_]/g,"_"),v=l("Material Design Icons",400,i),F=l("Roboto",400,f);e.push(`        // widget:template_sensor_bar id:${t.id} type:template_sensor_bar x:${t.x} y:${t.y} w:${t.width} h:${t.height} wifi:${w} temp:${a} hum:${x} bat:${I} bg:${A} bg_color:${s.background_color||"black"} radius:${E} border:${c} icon_size:${i} font_size:${f} color:${m} wifi_ent:"${s.wifi_entity||""}" temp_ent:"${s.temp_entity||""}" temp_unit:${s.temp_unit||"°C"} hum_ent:"${s.hum_entity||""}" bat_ent:"${s.bat_entity||""}" ${g(t)}`);const N=u(t);N&&e.push(`        ${N}`),e.push("        {"),A?E>0?(e.push("          auto draw_filled_rrect = [&](int x, int y, int w, int h, int r, auto c) {"),e.push("            it.filled_rectangle(x + r, y, w - 2 * r, h, c);"),e.push("            it.filled_rectangle(x, y + r, r, h - 2 * r, c);"),e.push("            it.filled_rectangle(x + w - r, y + r, r, h - 2 * r, c);"),e.push("            it.filled_circle(x + r, y + r, r, c);"),e.push("            it.filled_circle(x + w - r - 1, y + r, r, c);"),e.push("            it.filled_circle(x + r, y + h - r - 1, r, c);"),e.push("            it.filled_circle(x + w - r - 1, y + h - r - 1, r, c);"),e.push("          };"),c>0?(e.push(`          draw_filled_rrect(${t.x}, ${t.y}, ${t.width}, ${t.height}, ${E}, ${U});`),r(e,s.border_color||"white",o,t.x,t.y,t.width,t.height,E),e.push(`          draw_filled_rrect(${t.x+c}, ${t.y+c}, ${t.width-2*c}, ${t.height-2*c}, ${Math.max(0,E-c)}, ${k});`),n(s.background_color)!=="black"&&n(s.background_color)!=="#000000"&&r(e,s.background_color||"black",o,t.x+c,t.y+c,t.width-2*c,t.height-2*c,Math.max(0,E-c))):(e.push(`          draw_filled_rrect(${t.x}, ${t.y}, ${t.width}, ${t.height}, ${E}, ${k});`),r(e,s.background_color||"black",o,t.x,t.y,t.width,t.height,E))):c>0?(e.push(`          it.filled_rectangle(${t.x}, ${t.y}, ${t.width}, ${t.height}, ${U});`),r(e,s.border_color||"white",o,t.x,t.y,t.width,t.height,0),e.push(`          it.filled_rectangle(${t.x+c}, ${t.y+c}, ${t.width-2*c}, ${t.height-2*c}, ${k});`),n(s.background_color)!=="black"&&n(s.background_color)!=="#000000"&&r(e,s.background_color||"black",o,t.x+c,t.y+c,t.width-2*c,t.height-2*c,0)):(e.push(`          it.filled_rectangle(${t.x}, ${t.y}, ${t.width}, ${t.height}, ${k});`),r(e,s.background_color||"black",o,t.x,t.y,t.width,t.height,0)):c>0&&r(e,s.border_color||"white",o,t.x,t.y,t.width,t.height,E);let b=p;o&&(s.color==="gray"||s.color==="grey"||s.color==="#808080"||s.color==="#a0a0a0")&&(s.background_color==="black"||s.background_color==="#000000")&&(b="COLOR_WHITE");let S=0;if(w&&S++,a&&S++,x&&S++,I&&S++,S>0){const T=t.width/S;let y=t.x+T/2;const $=t.y+t.height/2;if(w&&(e.push("          {"),e.push('            const char* wifi_icon = "\\U000F092B";'),e.push(`            if (id(${C}).has_state()) {`),e.push(`              float sig = id(${C}).state;`),e.push('              if (sig >= -50) wifi_icon = "\\U000F0928";'),e.push('              else if (sig >= -70) wifi_icon = "\\U000F0925";'),e.push('              else if (sig >= -85) wifi_icon = "\\U000F0922";'),e.push('              else wifi_icon = "\\U000F091F";'),e.push("            }"),e.push(`            it.printf(${Math.round(y)} - 4, ${Math.round($)}, id(${v}), ${b}, TextAlign::CENTER_RIGHT, "%s", wifi_icon);`),e.push(`            if (id(${C}).has_state()) it.printf(${Math.round(y)} + 4, ${Math.round($)}, id(${F}), ${b}, TextAlign::CENTER_LEFT, "%.0fdB", id(${C}).state);`),e.push(`            else it.printf(${Math.round(y)} + 4, ${Math.round($)}, id(${F}), ${b}, TextAlign::CENTER_LEFT, "--dB");`),e.push("          }"),y+=T),a){const R=s.temp_unit||"°C";e.push("          {"),e.push(`            it.printf(${Math.round(y)} - 4, ${Math.round($)}, id(${v}), ${b}, TextAlign::CENTER_RIGHT, "%s", "\\U000F050F");`),e.push(`            if (id(${M}).has_state() && !std::isnan(id(${M}).state)) {`),R==="°F"||R==="F"?e.push(`              it.printf(${Math.round(y)} + 4, ${Math.round($)}, id(${F}), ${b}, TextAlign::CENTER_LEFT, "%.1f°F", id(${M}).state * 9.0 / 5.0 + 32.0);`):e.push(`              it.printf(${Math.round(y)} + 4, ${Math.round($)}, id(${F}), ${b}, TextAlign::CENTER_LEFT, "%.1f°C", id(${M}).state);`),e.push("            } else {"),e.push(`              it.printf(${Math.round(y)} + 4, ${Math.round($)}, id(${F}), ${b}, TextAlign::CENTER_LEFT, "--${R}");`),e.push("            }"),e.push("          }"),y+=T}x&&(e.push("          {"),e.push(`            it.printf(${Math.round(y)} - 4, ${Math.round($)}, id(${v}), ${b}, TextAlign::CENTER_RIGHT, "%s", "\\U000F058E");`),e.push(`            if (id(${L}).has_state()) it.printf(${Math.round(y)} + 4, ${Math.round($)}, id(${F}), ${b}, TextAlign::CENTER_LEFT, "%.0f%%", id(${L}).state);`),e.push(`            else it.printf(${Math.round(y)} + 4, ${Math.round($)}, id(${F}), ${b}, TextAlign::CENTER_LEFT, "--%%");`),e.push("          }"),y+=T),I&&(e.push("          {"),e.push('            const char* bat_icon = "\\U000F0082";'),e.push(`            float lvl = id(${z}).state;`),e.push('            if (lvl >= 90) bat_icon = "\\U000F0079";'),e.push('            else if (lvl >= 50) bat_icon = "\\U000F007E";'),e.push('            else if (lvl >= 20) bat_icon = "\\U000F007B";'),e.push('            else bat_icon = "\\U000F0083";'),e.push(`            it.printf(${Math.round(y)} - 4, ${Math.round($)}, id(${v}), ${b}, TextAlign::CENTER_RIGHT, "%s", bat_icon);`),e.push(`            if (id(${z}).has_state()) it.printf(${Math.round(y)} + 4, ${Math.round($)}, id(${F}), ${b}, TextAlign::CENTER_LEFT, "%.0f%%", id(${z}).state);`),e.push(`            else it.printf(${Math.round(y)} + 4, ${Math.round($)}, id(${F}), ${b}, TextAlign::CENTER_LEFT, "--%%");`),e.push("          }"))}e.push("        }"),N&&e.push("        }")},D=t=>{const{lines:h,widgets:e,isLvgl:l,pendingTriggers:_,profile:r}=t,g=e.filter(d=>d.type==="template_sensor_bar");if(g.length===0)return;if(g.forEach(d=>{const o=d.props||{},s=t.mainLines||h,n=i=>{!i||!l||!_||(_.has(i)||_.set(i,new Set),_.get(i).add(`- lvgl.widget.refresh: ${d.id}`))};if(o.show_wifi!==!1){let i=o.wifi_entity||"wifi_signal_dbm";i.includes(".")&&!i.startsWith("text_sensor.")&&(i.includes(".")||(i=`sensor.${i}`)),n(i),o.wifi_entity||!(t.seenSensorIds&&t.seenSensorIds.has("wifi_signal_dbm"))&&!s.some(m=>m.includes("id: wifi_signal_dbm"))&&!h.some(m=>m.includes("id: wifi_signal_dbm"))&&(t.seenSensorIds&&t.seenSensorIds.add("wifi_signal_dbm"),h.push("- platform: wifi_signal","  id: wifi_signal_dbm","  internal: true"))}if(o.show_battery!==!1){let i=o.bat_entity||"battery_level";i.includes(".")&&!i.startsWith("text_sensor.")&&(i.includes(".")||(i=`sensor.${i}`)),n(i),o.bat_entity||!(t.seenSensorIds&&t.seenSensorIds.has("battery_level"))&&!s.some(m=>m.includes("id: battery_level"))&&!h.some(m=>m.includes("id: battery_level"))&&(t.seenSensorIds&&t.seenSensorIds.add("battery_level"),h.push("- platform: template","  id: battery_level",'  name: "Battery Level"',"  unit_of_measurement: '%'","  update_interval: 60s","  internal: true"))}if(o.show_temperature!==!1){let i=o.temp_entity;i?i.includes(".")||(i=`sensor.${i}`):i=r.features?.sht4x?"sht4x_temperature":r.features?.sht3x||r.features?.sht3xd?"sht3x_temperature":"shtc3_temperature",n(i)}if(o.show_humidity!==!1){let i=o.hum_entity;i?i.includes(".")||(i=`sensor.${i}`):i=r.features?.sht4x?"sht4x_humidity":r.features?.sht3x||r.features?.sht3xd?"sht3x_humidity":"shtc3_humidity",n(i)}}),g.some(d=>{const o=d.props||{};return o.show_temperature!==!1&&!o.temp_entity||o.show_humidity!==!1&&!o.hum_entity})){const d=r.features?.sht4x,o=r.features?.sht3x||r.features?.sht3xd,s=d?"sht4x_sensor":o?"sht3x_sensor":"shtc3_sensor",n=d?"sht4x":o?"sht3xd":"shtcx",i=d?"sht4x_temperature":o?"sht3x_temperature":"shtc3_temperature",f=t.mainLines||h;if(!(t.seenSensorIds&&t.seenSensorIds.has(s)||t.seenSensorIds&&t.seenSensorIds.has(i))&&!f.some(p=>p.includes(`id: ${s}`))&&!f.some(p=>p.includes(`id: ${i}`))){t.seenSensorIds&&(t.seenSensorIds.add(s),t.seenSensorIds.add(i),t.seenSensorIds.add(d?"sht4x_humidity":o?"sht3x_humidity":"shtc3_humidity")),h.push(`- platform: ${n}`),h.push(`  id: ${s}`),(n==="sht3xd"||n==="sht4x")&&h.push("  address: 0x44"),n==="shtcx"&&(h.push("  i2c_id: bus_a"),h.push("  address: 0x70"));const p=g.some(a=>a.props?.show_temperature!==!1&&!a.props?.temp_entity),w=g.some(a=>a.props?.show_humidity!==!1&&!a.props?.hum_entity);if(p){const a=d?"sht4x_temperature":o?"sht3x_temperature":"shtc3_temperature";h.push("  temperature:"),h.push(`    id: ${a}`),h.push("    internal: true")}if(w){const a=d?"sht4x_humidity":o?"sht3x_humidity":"shtc3_humidity";h.push("  humidity:"),h.push(`    id: ${a}`),h.push("    internal: true")}h.push("  update_interval: 60s")}}},H=(t,h)=>{const{trackIcon:e,addFont:l}=h,_=t.props||{},r=parseInt(_.icon_size||20,10),g=parseInt(_.font_size||14,10);l("Material Design Icons",400,r),l("Material Design Icons",400,r),l("Roboto",400,g),_.show_wifi!==!1&&["F092B","F091F","F0922","F0925","F0928"].forEach(u=>e(u,r)),_.show_temperature!==!1&&["F050F"].forEach(u=>e(u,r)),_.show_humidity!==!1&&["F058E"].forEach(u=>e(u,r)),_.show_battery!==!1&&["F0082","F0079","F007E","F007B","F0083"].forEach(u=>e(u,r))},O={id:"template_sensor_bar",name:"Sensor Bar",category:"Templates",defaults:{w:355,h:43,show_wifi:!0,show_temperature:!0,show_humidity:!0,show_battery:!0,show_background:!0,background_color:"black",border_radius:8,color:"white",font_size:14,icon_size:20,temp_unit:"°C"},render:B,exportLVGL:(t,{common:h,convertColor:e,getLVGLFont:l,profile:_})=>{const r=t.props||{},g=a=>a==="gray"||a==="grey"?"#808080":a,u=e(g(r.color||"white")),d=parseInt(r.icon_size||20,10),o=parseInt(r.font_size||14,10),s=r.show_wifi!==!1,n=r.show_temperature!==!1,i=r.show_humidity!==!1,f=r.show_battery!==!1,m=l("Material Design Icons",d,400),p=l("Roboto",o,400),w=[];if(s){let a=`!lambda |-
`;a+=`              if (id(wifi_signal_dbm).has_state()) {
`,a+=`                float sig = id(wifi_signal_dbm).state;
`,a+=`                if (sig >= -50) return "\\U000F0928";
`,a+=`                else if (sig >= -70) return "\\U000F0925";
`,a+=`                else if (sig >= -85) return "\\U000F0922";
`,a+=`                else return "\\U000F091F";
`,a+=`              }
`,a+='              return "\\U000F092B";',w.push({obj:{width:"SIZE_CONTENT",height:"SIZE_CONTENT",bg_opa:"transp",border_width:0,layout:{type:"flex",flex_flow:"row",flex_align_main:"center",flex_align_cross:"center"},pad_all:0,widgets:[{label:{text:a,text_font:m,text_color:u}},{label:{text:`!lambda "return id(wifi_signal_dbm).has_state() ? str_sprintf('%.0fdB', id(wifi_signal_dbm).state).c_str() : '--dB';"`,text_font:p,text_color:u,x:4}}]}})}if(n){const a=(r.temp_entity||(_.features?.sht4x?"sht4x_temperature":_.features?.sht3x||_.features?.sht3xd?"sht3x_temperature":"shtc3_temperature")).replace(/[^a-zA-Z0-9_]/g,"_"),x=r.temp_unit||"°C";let I=`id(${a}).state`;x==="°F"&&(I=`(id(${a}).state * 9.0 / 5.0 + 32.0)`),w.push({obj:{width:"SIZE_CONTENT",height:"SIZE_CONTENT",bg_opa:"transp",border_width:0,layout:{type:"flex",flex_flow:"row",flex_align_main:"center",flex_align_cross:"center"},pad_all:0,widgets:[{label:{text:'"\\U000F050F"',text_font:m,text_color:u}},{label:{text:`!lambda "if (id(${a}).has_state()) { return str_sprintf('%.1f${x}', ${I}).c_str(); } return '--${x}';"`,text_font:p,text_color:u,x:4}}]}})}if(i){const a=(r.hum_entity||(_.features?.sht4x?"sht4x_humidity":_.features?.sht3x||_.features?.sht3xd?"sht3x_humidity":"shtc3_humidity")).replace(/[^a-zA-Z0-9_]/g,"_");w.push({obj:{width:"SIZE_CONTENT",height:"SIZE_CONTENT",bg_opa:"transp",border_width:0,layout:{type:"flex",flex_flow:"row",flex_align_main:"center",flex_align_cross:"center"},pad_all:0,widgets:[{label:{text:'"\\U000F058E"',text_font:m,text_color:u}},{label:{text:`!lambda "if (id(${a}).has_state()) { return str_sprintf('%.0f%%', id(${a}).state).c_str(); } return '--%';"`,text_font:p,text_color:u,x:4}}]}})}if(f){const a=(r.bat_entity||"battery_level").replace(/[^a-zA-Z0-9_]/g,"_");let x=`!lambda |-
`;x+=`              float lvl = id(${a}).state;
`,x+=`              if (lvl >= 90) return "\\U000F0079";
`,x+=`              else if (lvl >= 50) return "\\U000F007E";
`,x+=`              else if (lvl >= 20) return "\\U000F007B";
`,x+='              else return "\\U000F0083";',w.push({obj:{width:"SIZE_CONTENT",height:"SIZE_CONTENT",bg_opa:"transp",border_width:0,layout:{type:"flex",flex_flow:"row",flex_align_main:"center",flex_align_cross:"center"},pad_all:0,widgets:[{label:{text:x,text_font:m,text_color:u}},{label:{text:`!lambda "return id(${a}).has_state() ? str_sprintf('%.0f%%', id(${a}).state).c_str() : '--%';"`,text_font:p,text_color:u,x:4}}]}})}return{obj:{...h,bg_color:r.show_background!==!1?e(g(r.background_color||"black")):"transp",bg_opa:r.show_background!==!1?"cover":"transp",radius:r.border_radius||8,clip_corner:!0,border_width:r.border_thickness||0,border_color:e(g(r.border_color||"white")),layout:{type:"flex",flex_flow:"row",flex_align_main:"space_around",flex_align_cross:"center"},widgets:w}}},export:Z,onExportNumericSensors:D,collectRequirements:H};export{O as default};
