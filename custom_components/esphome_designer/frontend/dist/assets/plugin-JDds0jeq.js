const R=(t,m,{getColorStyle:d})=>{const e=m.props||{};t.innerHTML="",t.style.display="flex",t.style.flexDirection="column",t.style.justifyContent="center",t.style.alignItems="center";const c=d(e.color),o=(e.font_family||"Roboto")+", sans-serif",a=(e.text_align||"CENTER").toUpperCase();((_,p)=>{_&&(_.includes("LEFT")?p.style.alignItems="flex-start":_.includes("RIGHT")?p.style.alignItems="flex-end":p.style.alignItems="center",_.includes("TOP")?p.style.justifyContent="flex-start":_.includes("BOTTOM")?p.style.justifyContent="flex-end":p.style.justifyContent="center")})(a,t);const n=e.format||"time_date",i=document.createElement("div");i.style.fontSize=`${e.time_font_size||28}px`,i.style.color=c,i.style.fontFamily=o,i.style.fontWeight="bold";const s=document.createElement("div");s.style.fontSize=`${e.date_font_size||16}px`,s.style.color=c,s.style.fontFamily=o,s.style.opacity="0.8";const r=new Date,y=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],u=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],f=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],T=["January","February","March","April","May","June","July","August","September","October","November","December"],h=r.getHours().toString().padStart(2,"0")+":"+r.getMinutes().toString().padStart(2,"0"),x=y[r.getDay()]+", "+u[r.getMonth()]+" "+r.getDate(),g=r.getDate().toString().padStart(2,"0")+"."+(r.getMonth()+1).toString().padStart(2,"0")+"."+r.getFullYear(),S=f[r.getDay()]+" "+r.getDate().toString().padStart(2,"0")+" "+T[r.getMonth()];i.textContent=h,n==="time_only"?t.appendChild(i):n==="date_only"?(s.textContent=g,t.appendChild(s)):n==="weekday_day_month"?(s.textContent=S,t.appendChild(s)):(s.textContent=x,t.appendChild(i),t.appendChild(s))},b={id:"datetime",name:"Date & Time",category:"Core",supportedModes:["lvgl","direct","oepl","opendisplay"],defaults:{format:"time_date",time_font_size:28,date_font_size:16,color:"black",italic:!1,font_family:"Roboto",text_align:"CENTER",width:120,height:50},render:R,exportOpenDisplay:(t,{layout:m,page:d})=>{const e=t.props||{},c=e.format||"time_date",o=(e.text_align||"CENTER").toUpperCase();let a="";const l=new Date;c==="time_only"?a=l.getHours().toString().padStart(2,"0")+":"+l.getMinutes().toString().padStart(2,"0"):c==="date_only"?a=l.getDate().toString().padStart(2,"0")+"."+(l.getMonth()+1).toString().padStart(2,"0")+"."+l.getFullYear():a=l.getHours().toString().padStart(2,"0")+":"+l.getMinutes().toString().padStart(2,"0");const n=o.includes("CENTER")||o==="CENTER",i=o.includes("RIGHT"),s=o.includes("CENTER")||!o.includes("TOP")&&!o.includes("BOTTOM"),r=o.includes("BOTTOM"),y=Math.round(t.x+(n?t.width/2:i?t.width:0)),u=Math.round(t.y+(s?t.height/2:r?t.height:0));let f=e.color||"black";return f==="theme_auto"&&(f=m?.darkMode?"white":"black"),{type:"draw_text",x:y,y:u,text:a,size:e.time_font_size||28,color:f,font:e.font_family?.toLowerCase()||"roboto"}},exportOEPL:(t,{layout:m,page:d})=>{const e=t.props||{},c=e.format||"time_date",o=(e.text_align||"CENTER").toUpperCase();let a=e.color||"black";a==="theme_auto"&&(a=m?.darkMode?"white":"black");let l="";c==="time_only"?l="{{ now().strftime('%H:%M') }}":c==="date_only"?l="{{ now().strftime('%d.%m.%Y') }}":c==="weekday_day_month"?l="{{ now().strftime('%A %d %B') }}":l=`{{ now().strftime('%H:%M') }}
{{ now().strftime('%a, %b %d') }}`;const n=o.includes("CENTER")||o==="CENTER",i=o.includes("RIGHT"),s=o.includes("CENTER")||!o.includes("TOP")&&!o.includes("BOTTOM"),r=o.includes("BOTTOM"),y=Math.round(t.x+(n?t.width/2:i?t.width:0)),u=Math.round(t.y+(s?t.height/2:r?t.height:0)),f=e.time_font_size||28,T=5,h={type:"text",value:l,x:y,y:u,size:f,font:e.font_family?.includes("Mono")?"mononoki.ttf":"ppb.ttf",color:a,align:o.toLowerCase().replace("top_","").replace("bottom_","").replace("_",""),anchor:(s?"m":r?"b":"t")+(n?"c":i?"r":"l")};return t.width&&t.width>0&&(h.max_width=Math.round(t.width),h.spacing=T),h},exportLVGL:(t,{common:m,convertColor:d,convertAlign:e,getLVGLFont:c,formatOpacity:o})=>{const a=t.props||{},l=a.format||"time_date";let n="%H:%M";l==="date_only"?n="%d.%m.%Y":l==="weekday_day_month"?n="%A %d %B":l==="time_date"&&(n="%H:%M\\n%a, %b %d");let i=`!lambda |-
`;i+=`              auto now = id(ha_time).now();
`,i+=`              return now.strftime("${n}").c_str();`;const s=l==="date_only"||l==="weekday_day_month",r=s?a.date_font_size||16:a.time_font_size||28,y=s?400:700;return{label:{...m,text:i,text_font:c(a.font_family,r,y,a.italic),text_color:d(a.color),text_align:(e(a.text_align)||"center").replace("top_","").replace("bottom_",""),opa:o(a.opa)}}},collectRequirements:(t,m)=>{const{addFont:d}=m,e=t.props||{},c=parseInt(e.time_font_size||28,10),o=parseInt(e.date_font_size||16,10);d(e.font_family||"Roboto",700,c,!!e.italic),d(e.font_family||"Roboto",400,o,!!e.italic)},export:(t,m)=>{const{lines:d,getColorConst:e,addFont:c,getCondProps:o,getConditionCheck:a,getAlignY:l}=m,n=t.props||{},i=e(n.color||"black"),s=parseInt(n.time_font_size||28,10),r=parseInt(n.date_font_size||16,10),y=c(n.font_family||"Roboto",700,s,!!n.italic),u=c(n.font_family||"Roboto",400,r,!!n.italic),f=(n.text_align||"CENTER").toUpperCase(),T=n.format||"time_date";d.push(`        // widget:datetime id:${t.id} type:datetime x:${t.x} y:${t.y} w:${t.width} h:${t.height} fmt:${T} ${o(t)}`);const h=a(t);h&&d.push(`        ${h}`),d.push("        {"),d.push("          auto now = id(ha_time).now();");let x="LEFT";f.includes("CENTER")?x="CENTER":f.includes("RIGHT")&&(x="RIGHT");let g="TOP";f.includes("BOTTOM")?g="BOTTOM":(f.includes("CENTER")||f==="CENTER"||!f.includes("TOP")&&!f.includes("BOTTOM"))&&(g="CENTER");const _=((M,C)=>M==="CENTER"&&C==="CENTER"?"TextAlign::CENTER":`TextAlign::${C}_${M}`)(x,g);let p=t.x;x==="CENTER"?p=Math.round(t.x+t.width/2):x==="RIGHT"&&(p=Math.round(t.x+t.width));let E=t.y;if(g==="CENTER"?E=Math.round(t.y+t.height/2):g==="BOTTOM"&&(E=Math.round(t.y+t.height)),T==="time_only")d.push(`          it.strftime(${p}, ${E}, id(${y}), ${i}, ${_}, "%H:%M", now);`);else if(T==="date_only")d.push(`          it.strftime(${p}, ${E}, id(${u}), ${i}, ${_}, "%d.%m.%Y", now);`);else if(T==="weekday_day_month")d.push(`          it.strftime(${p}, ${E}, id(${u}), ${i}, ${_}, "%A %d %B", now);`);else{const M=s+r+2;let C=t.y;g==="CENTER"?C=Math.round(t.y+(t.height-M)/2):g==="BOTTOM"&&(C=Math.round(t.y+t.height-M));const $=`TextAlign::TOP_${x}`;d.push(`          it.strftime(${p}, ${C}, id(${y}), ${i}, ${$}, "%H:%M", now);`),d.push(`          it.strftime(${p}, ${C} + ${s} + 2, id(${u}), ${i}, ${$}, "%a, %b %d", now);`)}d.push("        }"),h&&d.push("        }")}};export{b as default};
