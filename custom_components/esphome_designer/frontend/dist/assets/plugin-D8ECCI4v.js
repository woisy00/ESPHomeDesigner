const Z=(t,$,{getColorStyle:e})=>{const n=$.props||{},l=n.color||"black",r=n.icon_size||20,m=n.font_size||14,a=n.border_thickness||0;t.style.display="flex",t.style.alignItems="center",t.style.justifyContent="space-around",t.style.padding="0 10px",t.style.boxSizing="border-box";let _=e(l);if(t.style.overflow="hidden",n.show_background){const s=e(n.background_color||"white");t.style.backgroundColor=s,t.style.borderRadius=(n.border_radius||8)+"px",a>0?t.style.border=`${a}px solid ${e(n.border_color||"white")}`:t.style.border="none",_==="#000000"&&s==="#000000"&&(_="#ffffff"),(!n.background_color||n.background_color==="transparent")&&(t.style.border="1px dashed #444")}else t.style.backgroundColor="transparent",t.style.borderRadius="0",t.style.border="none";t.style.color=_;const g=s=>{if(!window.AppState||!window.AppState.entityStates)return null;for(const c of s)if(c&&window.AppState.entityStates[c])return window.AppState.entityStates[c].state;return null},i=[];if(n.show_wifi){const s=g([n.wifi_entity,"wifi_signal_dbm","sensor.wifi_signal"]);i.push({type:"wifi",icon:"F0928",val:s!==null?Math.round(s)+"dB":"-65dB"})}if(n.show_temperature){const s=g([n.temp_entity,"sht4x_temperature","sht3x_temperature","shtc3_temperature","sensor.temperature"]),c=n.temp_unit||"°C";let f=s!==null?parseFloat(s):23.5;c==="°F"&&(f=f*9/5+32),i.push({type:"temp",icon:"F050F",val:f.toFixed(1)+c})}if(n.show_humidity){const s=g([n.hum_entity,"sht4x_humidity","shtc3_humidity","sensor.humidity"]);i.push({type:"hum",icon:"F058E",val:s!==null?Math.round(s)+"%":"45%"})}if(n.show_battery){const s=g([n.bat_entity,"battery_level","sensor.battery_level"]);i.push({type:"bat",icon:"F0079",val:s!==null?Math.round(s)+"%":"85%"})}t.innerHTML="",i.forEach(s=>{const c=document.createElement("div");c.style.display="flex",c.style.alignItems="center",c.style.gap="6px";const f=document.createElement("span"),E=parseInt(s.icon,16);f.innerText=String.fromCodePoint(E),f.style.fontFamily="'Material Design Icons', 'MDI', system-ui, -sans-serif",f.style.fontSize=r+"px",f.style.lineHeight="1";const x=document.createElement("span");x.innerText=s.val,x.style.fontSize=m+"px",x.style.fontFamily="Roboto, system-ui, -sans-serif",x.style.fontWeight="500",x.style.whiteSpace="nowrap",c.appendChild(f),c.appendChild(x),t.appendChild(c)})},H=(t,$)=>{const{lines:e,addFont:n,getColorConst:l,addDitherMask:r,getCondProps:m,getConditionCheck:a,profile:_,isEpaper:g}=$,i=t.props||{},s=M=>M==="gray"||M==="grey"?"#808080":M,c=parseInt(i.icon_size||20,10),f=parseInt(i.font_size||14,10),E=s(i.color||"white"),x=l(E),w=i.show_wifi!==!1,o=i.show_temperature!==!1,b=i.show_humidity!==!1,I=i.show_battery!==!1,B=i.show_background!==!1,z=l(s(i.background_color||"black")),T=parseInt(i.border_radius||8,10),h=parseInt(i.border_thickness||0,10),L=l(s(i.border_color||"white")),F=(i.wifi_entity||"wifi_signal_dbm").replace(/[^a-zA-Z0-9_]/g,"_"),N=(i.bat_entity||(_.pins?.batteryAdc?"battery_level":"")).replace(/[^a-zA-Z0-9_]/g,"_"),v=(i.hum_entity||(_.features?.sht4x?"sht4x_humidity":_.features?.sht3x||_.features?.sht3xd?"sht3x_humidity":_.features?.shtc3?"shtc3_humidity":"")).replace(/[^a-zA-Z0-9_]/g,"_"),k=(i.temp_entity||(_.features?.sht4x?"sht4x_temperature":_.features?.sht3x||_.features?.sht3xd?"sht3x_temperature":_.features?.shtc3?"shtc3_temperature":"")).replace(/[^a-zA-Z0-9_]/g,"_"),R=n("Material Design Icons",400,c),y=n("Roboto",400,f);e.push(`        // widget:template_sensor_bar id:${t.id} type:template_sensor_bar x:${t.x} y:${t.y} w:${t.width} h:${t.height} wifi:${w} temp:${o} hum:${b} bat:${I} bg:${B} bg_color:${i.background_color||"black"} radius:${T} border:${h} icon_size:${c} font_size:${f} color:${E} wifi_ent:"${i.wifi_entity||""}" temp_ent:"${i.temp_entity||""}" temp_unit:${i.temp_unit||"°C"} hum_ent:"${i.hum_entity||""}" bat_ent:"${i.bat_entity||""}" ${m(t)}`);const U=a(t);U&&e.push(`        ${U}`),e.push("        {"),B?T>0?(e.push("          auto draw_filled_rrect = [&](int x, int y, int w, int h, int r, auto c) {"),e.push("            it.filled_rectangle(x + r, y, w - 2 * r, h, c);"),e.push("            it.filled_rectangle(x, y + r, r, h - 2 * r, c);"),e.push("            it.filled_rectangle(x + w - r, y + r, r, h - 2 * r, c);"),e.push("            it.filled_circle(x + r, y + r, r, c);"),e.push("            it.filled_circle(x + w - r - 1, y + r, r, c);"),e.push("            it.filled_circle(x + r, y + h - r - 1, r, c);"),e.push("            it.filled_circle(x + w - r - 1, y + h - r - 1, r, c);"),e.push("          };"),h>0?(e.push(`          draw_filled_rrect(${t.x}, ${t.y}, ${t.width}, ${t.height}, ${T}, ${L});`),r(e,i.border_color||"white",g,t.x,t.y,t.width,t.height,T),e.push(`          draw_filled_rrect(${t.x+h}, ${t.y+h}, ${t.width-2*h}, ${t.height-2*h}, ${Math.max(0,T-h)}, ${z});`),s(i.background_color)!=="black"&&s(i.background_color)!=="#000000"&&r(e,i.background_color||"black",g,t.x+h,t.y+h,t.width-2*h,t.height-2*h,Math.max(0,T-h))):(e.push(`          draw_filled_rrect(${t.x}, ${t.y}, ${t.width}, ${t.height}, ${T}, ${z});`),r(e,i.background_color||"black",g,t.x,t.y,t.width,t.height,T))):h>0?(e.push(`          it.filled_rectangle(${t.x}, ${t.y}, ${t.width}, ${t.height}, ${L});`),r(e,i.border_color||"white",g,t.x,t.y,t.width,t.height,0),e.push(`          it.filled_rectangle(${t.x+h}, ${t.y+h}, ${t.width-2*h}, ${t.height-2*h}, ${z});`),s(i.background_color)!=="black"&&s(i.background_color)!=="#000000"&&r(e,i.background_color||"black",g,t.x+h,t.y+h,t.width-2*h,t.height-2*h,0)):(e.push(`          it.filled_rectangle(${t.x}, ${t.y}, ${t.width}, ${t.height}, ${z});`),r(e,i.background_color||"black",g,t.x,t.y,t.width,t.height,0)):h>0&&r(e,i.border_color||"white",g,t.x,t.y,t.width,t.height,T);let u=x;g&&(i.color==="gray"||i.color==="grey"||i.color==="#808080"||i.color==="#a0a0a0")&&(i.background_color==="black"||i.background_color==="#000000")&&(u="COLOR_WHITE");let S=0;if(w&&S++,o&&S++,b&&S++,I&&S++,S>0){const M=t.width/S;let d=t.x+M/2;const p=t.y+t.height/2,A=C=>$.seenSensorIds&&$.seenSensorIds.has(C)||C==="battery_level"&&$.profile?.pins?.batteryAdc;if(w&&(e.push("          {"),e.push('            const char* wifi_icon = "\\U000F092B";'),F&&A(F)&&(e.push(`            if (id(${F}).has_state()) {`),e.push(`              float sig = id(${F}).state;`),e.push('              if (sig >= -50) wifi_icon = "\\U000F0928";'),e.push('              else if (sig >= -70) wifi_icon = "\\U000F0925";'),e.push('              else if (sig >= -85) wifi_icon = "\\U000F0922";'),e.push('              else wifi_icon = "\\U000F091F";'),e.push("            }")),e.push(`            it.printf(${Math.round(d)} - 4, ${Math.round(p)}, id(${R}), ${u}, TextAlign::CENTER_RIGHT, "%s", wifi_icon);`),F&&A(F)?(e.push(`            if (id(${F}).has_state()) it.printf(${Math.round(d)} + 4, ${Math.round(p)}, id(${y}), ${u}, TextAlign::CENTER_LEFT, "%.0fdB", id(${F}).state);`),e.push(`            else it.printf(${Math.round(d)} + 4, ${Math.round(p)}, id(${y}), ${u}, TextAlign::CENTER_LEFT, "--dB");`)):e.push(`            it.printf(${Math.round(d)} + 4, ${Math.round(p)}, id(${y}), ${u}, TextAlign::CENTER_LEFT, "--dB");`),e.push("          }"),d+=M),o){const C=i.temp_unit||"°C";e.push("          {"),e.push(`            it.printf(${Math.round(d)} - 4, ${Math.round(p)}, id(${R}), ${u}, TextAlign::CENTER_RIGHT, "%s", "\\U000F050F");`),k&&A(k)?(e.push(`            if (id(${k}).has_state() && !std::isnan(id(${k}).state)) {`),C==="°F"||C==="F"?e.push(`              it.printf(${Math.round(d)} + 4, ${Math.round(p)}, id(${y}), ${u}, TextAlign::CENTER_LEFT, "%.1f°F", id(${k}).state * 9.0 / 5.0 + 32.0);`):e.push(`              it.printf(${Math.round(d)} + 4, ${Math.round(p)}, id(${y}), ${u}, TextAlign::CENTER_LEFT, "%.1f°C", id(${k}).state);`),e.push("            } else {"),e.push(`              it.printf(${Math.round(d)} + 4, ${Math.round(p)}, id(${y}), ${u}, TextAlign::CENTER_LEFT, "--${C}");`),e.push("            }")):e.push(`            it.printf(${Math.round(d)} + 4, ${Math.round(p)}, id(${y}), ${u}, TextAlign::CENTER_LEFT, "--${C}");`),e.push("          }"),d+=M}b&&(e.push("          {"),e.push(`            it.printf(${Math.round(d)} - 4, ${Math.round(p)}, id(${R}), ${u}, TextAlign::CENTER_RIGHT, "%s", "\\U000F058E");`),v&&A(v)?(e.push(`            if (id(${v}).has_state()) it.printf(${Math.round(d)} + 4, ${Math.round(p)}, id(${y}), ${u}, TextAlign::CENTER_LEFT, "%.0f%%", id(${v}).state);`),e.push(`            else it.printf(${Math.round(d)} + 4, ${Math.round(p)}, id(${y}), ${u}, TextAlign::CENTER_LEFT, "--%%");`)):e.push(`            it.printf(${Math.round(d)} + 4, ${Math.round(p)}, id(${y}), ${u}, TextAlign::CENTER_LEFT, "--%%");`),e.push("          }"),d+=M),I&&(e.push("          {"),e.push('            const char* bat_icon = "\\U000F0082";'),N&&A(N)?(e.push(`            float lvl = id(${N}).state;`),e.push('            if (lvl >= 90) bat_icon = "\\U000F0079";'),e.push('            else if (lvl >= 50) bat_icon = "\\U000F007E";'),e.push('            else if (lvl >= 20) bat_icon = "\\U000F007B";'),e.push('            else bat_icon = "\\U000F0083";'),e.push(`            it.printf(${Math.round(d)} - 4, ${Math.round(p)}, id(${R}), ${u}, TextAlign::CENTER_RIGHT, "%s", bat_icon);`),e.push(`            if (id(${N}).has_state()) it.printf(${Math.round(d)} + 4, ${Math.round(p)}, id(${y}), ${u}, TextAlign::CENTER_LEFT, "%.0f%%", id(${N}).state);`),e.push(`            else it.printf(${Math.round(d)} + 4, ${Math.round(p)}, id(${y}), ${u}, TextAlign::CENTER_LEFT, "--%%");`)):(e.push(`            it.printf(${Math.round(d)} - 4, ${Math.round(p)}, id(${R}), ${u}, TextAlign::CENTER_RIGHT, "%s", bat_icon);`),e.push(`            it.printf(${Math.round(d)} + 4, ${Math.round(p)}, id(${y}), ${u}, TextAlign::CENTER_LEFT, "--%%");`)),e.push("          }"))}e.push("        }"),U&&e.push("        }")},D=t=>{const{lines:$,widgets:e,isLvgl:n,pendingTriggers:l,profile:r}=t,m=e.filter(a=>a.type==="template_sensor_bar");m.length!==0&&m.forEach(a=>{const _=a.props||{},g=t.mainLines||$,i=s=>{!s||!n||!l||(l.has(s)||l.set(s,new Set),l.get(s).add(`- lvgl.widget.refresh: ${a.id}`))};if(_.show_wifi!==!1){let s=_.wifi_entity||"wifi_signal_dbm";s.includes(".")&&!s.startsWith("text_sensor.")&&(s.includes(".")||(s=`sensor.${s}`)),i(s),_.wifi_entity||!(t.seenSensorIds&&t.seenSensorIds.has("wifi_signal_dbm"))&&!g.some(f=>f.includes("id: wifi_signal_dbm"))&&!$.some(f=>f.includes("id: wifi_signal_dbm"))&&(t.seenSensorIds&&t.seenSensorIds.add("wifi_signal_dbm"),$.push("- platform: wifi_signal","  id: wifi_signal_dbm","  internal: true"))}})},O=(t,$)=>{const{trackIcon:e,addFont:n}=$,l=t.props||{},r=parseInt(l.icon_size||20,10),m=parseInt(l.font_size||14,10);n("Material Design Icons",400,r),n("Material Design Icons",400,r),n("Roboto",400,m),l.show_wifi!==!1&&["F092B","F091F","F0922","F0925","F0928"].forEach(a=>e(a,r)),l.show_temperature!==!1&&["F050F"].forEach(a=>e(a,r)),l.show_humidity!==!1&&["F058E"].forEach(a=>e(a,r)),l.show_battery!==!1&&["F0082","F0079","F007E","F007B","F0083"].forEach(a=>e(a,r))},W={id:"template_sensor_bar",name:"Sensor Bar",category:"Templates",supportedModes:["lvgl","direct"],defaults:{w:355,h:43,show_wifi:!0,show_temperature:!0,show_humidity:!0,show_battery:!0,show_background:!0,background_color:"black",border_radius:8,color:"white",font_size:14,icon_size:20,temp_unit:"°C"},render:Z,exportLVGL:(t,{common:$,convertColor:e,getLVGLFont:n,profile:l})=>{const r=t.props||{},m=o=>o==="gray"||o==="grey"?"#808080":o,a=e(m(r.color||"white")),_=parseInt(r.icon_size||20,10),g=parseInt(r.font_size||14,10),i=r.show_wifi!==!1,s=r.show_temperature!==!1,c=r.show_humidity!==!1,f=r.show_battery!==!1,E=n("Material Design Icons",_,400),x=n("Roboto",g,400),w=[];if(i){let o=`!lambda |-
`;o+=`              if (id(wifi_signal_dbm).has_state()) {
`,o+=`                float sig = id(wifi_signal_dbm).state;
`,o+=`                if (sig >= -50) return "\\U000F0928";
`,o+=`                else if (sig >= -70) return "\\U000F0925";
`,o+=`                else if (sig >= -85) return "\\U000F0922";
`,o+=`                else return "\\U000F091F";
`,o+=`              }
`,o+='              return "\\U000F092B";',w.push({obj:{width:"SIZE_CONTENT",height:"SIZE_CONTENT",bg_opa:"transp",border_width:0,layout:{type:"flex",flex_flow:"row",flex_align_main:"center",flex_align_cross:"center"},pad_all:0,widgets:[{label:{text:o,text_font:E,text_color:a}},{label:{text:`!lambda "return id(wifi_signal_dbm).has_state() ? str_sprintf('%.0fdB', id(wifi_signal_dbm).state).c_str() : '--dB';"`,text_font:x,text_color:a,x:4}}]}})}if(s){const o=(r.temp_entity||(l.features?.sht4x?"sht4x_temperature":l.features?.sht3x||l.features?.sht3xd?"sht3x_temperature":"shtc3_temperature")).replace(/[^a-zA-Z0-9_]/g,"_"),b=r.temp_unit||"°C";let I=`id(${o}).state`;b==="°F"&&(I=`(id(${o}).state * 9.0 / 5.0 + 32.0)`),w.push({obj:{width:"SIZE_CONTENT",height:"SIZE_CONTENT",bg_opa:"transp",border_width:0,layout:{type:"flex",flex_flow:"row",flex_align_main:"center",flex_align_cross:"center"},pad_all:0,widgets:[{label:{text:'"\\U000F050F"',text_font:E,text_color:a}},{label:{text:`!lambda "if (id(${o}).has_state()) { return str_sprintf('%.1f${b}', ${I}).c_str(); } return '--${b}';"`,text_font:x,text_color:a,x:4}}]}})}if(c){const o=(r.hum_entity||(l.features?.sht4x?"sht4x_humidity":l.features?.sht3x||l.features?.sht3xd?"sht3x_humidity":"shtc3_humidity")).replace(/[^a-zA-Z0-9_]/g,"_");w.push({obj:{width:"SIZE_CONTENT",height:"SIZE_CONTENT",bg_opa:"transp",border_width:0,layout:{type:"flex",flex_flow:"row",flex_align_main:"center",flex_align_cross:"center"},pad_all:0,widgets:[{label:{text:'"\\U000F058E"',text_font:E,text_color:a}},{label:{text:`!lambda "if (id(${o}).has_state()) { return str_sprintf('%.0f%%', id(${o}).state).c_str(); } return '--%';"`,text_font:x,text_color:a,x:4}}]}})}if(f){const o=(r.bat_entity||"battery_level").replace(/[^a-zA-Z0-9_]/g,"_");let b=`!lambda |-
`;b+=`              float lvl = id(${o}).state;
`,b+=`              if (lvl >= 90) return "\\U000F0079";
`,b+=`              else if (lvl >= 50) return "\\U000F007E";
`,b+=`              else if (lvl >= 20) return "\\U000F007B";
`,b+='              else return "\\U000F0083";',w.push({obj:{width:"SIZE_CONTENT",height:"SIZE_CONTENT",bg_opa:"transp",border_width:0,layout:{type:"flex",flex_flow:"row",flex_align_main:"center",flex_align_cross:"center"},pad_all:0,widgets:[{label:{text:b,text_font:E,text_color:a}},{label:{text:`!lambda "return id(${o}).has_state() ? str_sprintf('%.0f%%', id(${o}).state).c_str() : '--%';"`,text_font:x,text_color:a,x:4}}]}})}return{obj:{...$,bg_color:r.show_background!==!1?e(m(r.background_color||"black")):"transp",bg_opa:r.show_background!==!1?"cover":"transp",radius:r.border_radius||8,clip_corner:!0,border_width:r.border_thickness||0,border_color:e(m(r.border_color||"white")),layout:{type:"flex",flex_flow:"row",flex_align_main:"space_around",flex_align_cross:"center"},widgets:w}}},export:H,onExportNumericSensors:D,collectRequirements:O};export{W as default};
